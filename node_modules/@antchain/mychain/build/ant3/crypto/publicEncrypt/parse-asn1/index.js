"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var asn1=require("./asn1"),fixProc=require("./fixProc"),Buffer=require("safe-buffer").Buffer;function parseKeys(e){"object"!==_typeof(e)||Buffer.isBuffer(e)||(a=e.passphrase,e=e.key),"string"==typeof e&&(e=new Buffer(e));var r,t,a=fixProc(e,a),o=a.tag,n=a.data;switch(o){case"CERTIFICATE":t=asn1.certificate.decode(n,"der").tbsCertificate.subjectPublicKeyInfo;case"PUBLIC KEY":switch(r=(t=t||asn1.PublicKey.decode(n,"der")).algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return asn1.RSAPublicKey.decode(t.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return t.subjectPrivateKey=t.subjectPublicKey,{type:"ec",data:t};case"1.2.840.10040.4.1":return t.algorithm.params.pub_key=asn1.DSAparam.decode(t.subjectPublicKey.data,"der"),{type:"dsa",data:t.algorithm.params};default:throw new Error("unknown key id "+r)}throw new Error("unknown key type "+o);case"ENCRYPTED PRIVATE KEY":n=asn1.EncryptedPrivateKey.decode(n,"der");case"PRIVATE KEY":switch(r=(t=asn1.PrivateKey.decode(n,"der")).algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return asn1.RSAPrivateKey.decode(t.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:t.algorithm.curve,privateKey:asn1.ECPrivateKey.decode(t.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return t.algorithm.params.priv_key=asn1.DSAparam.decode(t.subjectPrivateKey,"der"),{type:"dsa",params:t.algorithm.params};default:throw new Error("unknown key id "+r)}throw new Error("unknown key type "+o);case"RSA PUBLIC KEY":return asn1.RSAPublicKey.decode(n,"der");case"RSA PRIVATE KEY":return asn1.RSAPrivateKey.decode(n,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:asn1.DSAPrivateKey.decode(n,"der")};case"EC PRIVATE KEY":return{curve:(n=asn1.ECPrivateKey.decode(n,"der")).parameters.value,privateKey:n.privateKey};default:throw new Error("unknown key type "+o)}}(module.exports=parseKeys).signature=asn1.signature;