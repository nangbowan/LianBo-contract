"use strict";var findProc=/Proc-Type: 4,ENCRYPTED[\n\r]+DEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)[\n\r]+([0-9A-z\n\r\+\/\=]+)[\n\r]+/m,startRegex=/^-----BEGIN ((?:.* KEY)|CERTIFICATE)-----/m,fullRegex=/^-----BEGIN ((?:.* KEY)|CERTIFICATE)-----([0-9A-z\n\r\+\/\=]+)-----END \1-----$/m,evp=require("evp_bytestokey"),ciphers=require("browserify-aes"),Buffer=require("safe-buffer").Buffer;module.exports=function(e,r){var f,a,t,n=e.toString(),u=n.match(findProc);return t=u?(f="aes"+u[1],a=new Buffer(u[2],"hex"),e=new Buffer(u[3].replace(/[\r\n]/g,""),"base64"),r=evp(r,a.slice(0,8),parseInt(u[1],10)).key,u=[],a=ciphers.createDecipheriv(f,r,a),u.push(a.update(e)),u.push(a.final()),Buffer.concat(u)):(t=n.match(fullRegex),new Buffer(t[2].replace(/[\r\n]/g,""),"base64")),{tag:n.match(startRegex)[1],data:t}};