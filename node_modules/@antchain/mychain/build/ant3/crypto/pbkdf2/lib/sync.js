"use strict";var sizes={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20},createHmac=require("create-hmac"),checkParameters=require("../lib/precondition"),defaultEncoding="utf-8",Buffer=require("safe-buffer").Buffer;function pbkdf2(e,r,f,a,t){checkParameters(e,r,f,a),Buffer.isBuffer(e)||(e=Buffer.from(e,defaultEncoding)),Buffer.isBuffer(r)||(r=Buffer.from(r,defaultEncoding)),t=t||"sha1";var u=Buffer.allocUnsafe(a),c=Buffer.allocUnsafe(r.length+4);r.copy(c,0,0,r.length);for(var s=0,i=sizes[t],d=Math.ceil(a/i),n=1;n<=d;n++){c.writeUInt32BE(n,r.length);for(var o=createHmac(t,e).update(c).digest(),h=o,l=1;l<f;l++)for(var h=createHmac(t,e).update(h).digest(),m=0;m<i;m++)o[m]^=h[m];o.copy(u,s),s+=i}return u}module.exports=pbkdf2;