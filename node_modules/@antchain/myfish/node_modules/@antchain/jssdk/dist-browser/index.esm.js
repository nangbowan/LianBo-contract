import e from"@babel/runtime/helpers/esm/objectSpread2";import t from"@babel/runtime/regenerator";import r from"@babel/runtime/helpers/esm/asyncToGenerator";import n from"@babel/runtime/helpers/esm/typeof";import a from"@babel/runtime/helpers/esm/classCallCheck";import o from"@babel/runtime/helpers/esm/createClass";import s from"debug";import c from"@babel/runtime/helpers/esm/inherits";import i from"@babel/runtime/helpers/esm/createSuper";import u from"@babel/runtime/helpers/esm/wrapNativeSuper";import p from"@babel/runtime/helpers/esm/defineProperty";import f from"bignumber.js";import{enc as h,SHA256 as y,AES as l,pad as d,mode as m}from"crypto-js";import v from"crypto-js/sha3";import{Buffer as g}from"safe-buffer";import{decode as _,encode as k}from"rlp";import{sign as w}from"secp256k1";import b from"md5.js";import x from"public-encrypt/browser";import{createCipheriv as C,createDecipheriv as q}from"browserify-aes/browser";import E from"create-hash";import T from"js-encoding-utils";import{ec as S}from"elliptic";import{define as P}from"asn1.js";import N from"bn.js";import B from"@babel/runtime/helpers/esm/toConsumableArray";import I from"@babel/runtime/helpers/esm/createForOfIteratorHelper";import R from"fcbuffer";import K from"node-forge";import A from"events";import O from"tls";import{nanoid as D}from"nanoid";import L from"axios";import{v4 as W}from"uuid";import{JsonRpcEngine as U}from"json-rpc-engine";import{createStreamMiddleware as z}from"json-rpc-middleware-stream";import M from"pump";var F="1"===process.env.MYFISH_DEBUG,j="development"===process.env.NODE_ENV,H=require("is-electron")(),Q="undefined"==typeof window&&"undefined"==typeof chrome&&!H,V="undefined"!=typeof chrome&&"undefined"==typeof window,Y=function(){return s.enable("antchain:*")};function J(e){return(j||F)&&Y(),s(e)}"undefined"!=typeof window&&(window.enableDebug=Y),"undefined"!=typeof globalThis&&(globalThis.enableDebug=Y);var G,$,X,Z,ee,te=J("antchain:jssdk");!function(e){e.assemblyscript="assemblyscript",e.solidity="solidity"}(G||(G={})),function(e){e.WASM="WASM",e.EVM="EVM"}($||($={})),function(e){e.TX_DEPLOY_CONTRACT="TX_DEPLOY_CONTRACT",e.CALL_CONTRACT="CALL_CONTRACT"}(X||(X={})),function(e){e.queryBlock="QueryBlock",e.queryLastBlock="QueryLastBlock",e.queryTransaction="QueryTransaction",e.queryTransactionReceipt="QueryTransactionReceipt",e.queryAccount="QueryAccount",e.queryContract="QueryContract",e.deployContract="DeployContract",e.updateContract="UpdateContract",e.callContract="CallContract",e.encryptedTransaction="EncryptedTransaction",e.LocalTransaction="LocalTransaction"}(Z||(Z={})),function(e){e.queryBlock="QUERYBLOCKBODY",e.queryBlockHeader="QUERYBLOCK",e.queryLastBlock="QUERYLASTBLOCK",e.queryTransactionFromBlockchain="QUERYTRANSACTIONFROMBLOCKCHAIN",e.queryTransactionReceipt="QUERYRECEIPT",e.queryAccount="QUERYACCOUNT",e.queryContract="QUERYCONTRACT",e.deploySolidityContractForBizAsync="DEPLOYCONTRACTFORBIZASYNC",e.updateSolidityContractForBizAsync="UPDATECONTRACTFORBIZASYNC",e.deployWasmContractForBiz="DEPLOYWASMCONTRACT",e.updateWasmContractForBiz="UPDATECONTRACTFORBIZ",e.deployWasmContract="DEPLOYCONTRACT",e.updateWasmContract="UPDATECONTRACT",e.callWasmContractForBiz="CALLWASMCONTRACT",e.callWasmContractForBizAsync="CALLWASMCONTRACTASYNC",e.callWasmContract="CALLWASMCONTRACT",e.callContract="CALLCONTRACT",e.createAccountForBiz="TENANTCREATEACCUNT"}(ee||(ee={}));var re,ne=p({default:"/api/contract/chainCall"},ee.callWasmContract,"/api/contract/chainCallForBiz");!function(e){e.queryBlockHeader="antchain_queryBlockHeader",e.queryBlock="antchain_queryBlock",e.queryLastBlock="antchain_queryLastBlock",e.queryTransaction="antchain_queryTransaction",e.queryTransactionReceipt="antchain_queryTransactionReceipt",e.queryAccount="antchain_queryAccount",e.queryContract="antchain_queryContract",e.sign="antchain_sign",e.deployContract="antchain_deployContract",e.deployWasmContract="antchain_deployWasmContract",e.deploySolidityContract="antchain_deploySolidityContract",e.callContract="antchain_callContract",e.callWasmContract="antchain_callWasmContract",e.callSolidityContract="antchain_callSolidityContract",e.getProviderState="antchain_getProviderState",e.requestAccounts="antchain_requestAccounts",e.subscription="antchain_subscription"}(re||(re={}));var ae,oe=function(e){c(r,u(Error));var t=i(r);function r(e,n,o){var s;return a(this,r),(s=t.call(this,e)).code=void 0,s.data=void 0,s.name="AntchainSDKError",s.code=n,s.data=o,s}return o(r)}();!function(e){e[e.ACCOUNT=0]="ACCOUNT",e[e.CONTRACT=1]="CONTRACT",e[e.TOPICS=2]="TOPICS",e[e.BLOCK=3]="BLOCK"}(ae||(ae={}));var se,ce,ie,ue=function(){function s(e,t){a(this,s),this.options=void 0,this.provider=void 0,this.contractName=void 0,this.contractType=void 0,this.vmType=void 0,this.abi=void 0,te("[Contract] new contarct with options:",e),this.options=e,this.provider=t;var r=e.contractType,o=void 0===r?G.assemblyscript:r,c=e.abi;this.contractName=e.contractName,this.contractType=o,this.vmType=o===G.solidity?$.EVM:$.WASM,this.abi="object"===n(c)?JSON.stringify(c):c}var c,i;return o(s,[{key:"on",value:function(e,t){this.provider.watchContractEvent(this,e,t)}},{key:"deploy",value:(i=r(t.mark((function e(r,n){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n||{}).update){e.next=5;break}return e.abrupt("return",this.provider.updateContract(this,r));case 5:return e.abrupt("return",this.provider.deployContract(this,r));case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"call",value:(c=r(t.mark((function r(n){return t.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(1===this.provider.majorVersion){t.next=4;break}if(this.vmType!==$.EVM){t.next=3;break}throw Error("当前版本的连接器不支持调用 Solidity 合约，请升级。");case 3:return t.abrupt("return",this.provider.callContract(e({contractName:this.contractName,vmType:this.vmType,abi:this.abi},n)));case 4:return t.abrupt("return",this.provider.callContract(this,n));case 5:case"end":return t.stop()}}),r,this)}))),function(e){return c.apply(this,arguments)})},{key:"generateDeployCode",value:function(e,t){throw Error("不能直接调用 Contract 类的 generateDeployCode")}},{key:"generateCallCode",value:function(e,t){throw Error("不能直接调用 Contract 类的 generateCallCode")}},{key:"parseReturnOutput",value:function(e,t){throw Error("不能直接调用 Contract 类的 generateCallCode")}}]),s}(),pe=String.fromCharCode;function fe(e){for(var t,r,n=[],a=0,o=e.length;o>a;)55296>(t=e.charCodeAt(a++))||t>56319||a>=o?n.push(t):56320==(64512&(r=e.charCodeAt(a++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),a--);return n}function he(e){if(e>=55296&&57343>=e)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value")}function ye(e,t){return pe(e>>t&63|128)}function le(e){if(0==(4294967168&e))return pe(e);var t="";return 0==(4294965248&e)?t=pe(e>>6&31|192):0==(4294901760&e)?(he(e),t=pe(e>>12&15|224),t+=ye(e,6)):0==(4292870144&e)&&(t=pe(e>>18&7|240),t+=ye(e,12),t+=ye(e,6)),t+=pe(63&e|128)}function de(){if(ie>=ce)throw Error("Invalid byte index");var e=255&se[ie];if(ie++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}var me=function(e){for(var t=fe(e),r=t.length,n=-1,a="";++n<r;)a+=le(t[n]);return a},ve=function(e){se=fe(e),ce=se.length,ie=0;for(var t,r,n,a=[];!1!==(r=void 0,n=void 0,t=ie!=ce&&(r=255&se[ie],ie++,0==(128&r)?r:192!=(224&r)||128>(n=(31&r)<<6|de())?224!=(240&r)||2048>(n=(15&r)<<12|de()<<6|de())?240!=(248&r)||65536>(n=(7&r)<<18|de()<<12|de()<<6|de())||n>1114111?void 0:n:(he(n),n):n));)a.push(t);return function(e){for(var t,r=e.length,n=-1,a="";++n<r;)(t=e[n])>65535&&(a+=pe((t-=65536)>>>10&1023|55296),t=56320|1023&t),a+=pe(t);return a}(a)};function ge(e,t){var r=e;return"hex"===t&&(r.length>2&&"0x"===r.substr(0,2)&&(r=r.substr(2)),r=h.Hex.parse(r)),""+v(r,{outputLength:256})}function _e(e,t){var r="0x";t&&(r="");var n=e.toString("hex");if(be(e)){if("0x"!==e.substr(0,2))return r+""+y(e);n=e.substr(2)}var a=h.Hex.parse(n);return r+y(a).toString(h.Hex)}function ke(e){return g.isBuffer(e)}function we(e){return e&&(e instanceof f||e.constructor&&"BigNumber"===e.constructor.name)}function be(e){return"string"==typeof e||e&&e.constructor&&"String"===e.constructor.name}function xe(e){return null!==e&&!Array.isArray(e)&&"object"===n(e)}function Ce(e){return Array.isArray(e)}function qe(e,t){var r=e,n=t;if(ke(r))return r;"number"==typeof r&&(r=r.toString(16)),be(r)&&0===r.indexOf("0x")&&(r=r.slice(2)),n||(n=Math.ceil(r.length/2));for(var a=g.alloc(n),o=0;n>o;o++){var s=r.slice(2*o,2*o+2)||"00";a.write(s,o,1,"hex")}return a}function Ee(e,t,r){return function(e,t,r){return parseInt(t)>e.length?Array(parseInt(t)-e.length+1).join(r||"0")+e:e}(e,t,r)}function Te(e,t,r){return parseInt(t)>e.length?e+Array(parseInt(t)-e.length+1).join(r||"0"):e}function Se(e,t,r){return Te(e,t,r)}function Pe(e,t){var r=e||0;return we(r)?r:be(r)?0===r.indexOf("0x")||0===r.indexOf("-0x")?new f(r.replace("0x",""),16):new f(r,t||16):new f(r.toString(10),10)}function Ne(e,t){return Pe(e,t).toNumber()}function Be(e,t){var r="0x";t&&(r="");var n=Pe(e),a=n.toString(16);return n.lessThan(0)?"-"+r+a.substr(1):r+a}function Ie(e,t,r){for(var n=me(e),a="",o=0;n.length>o;o++){var s=n.charCodeAt(o);if(0===s){if(!t)break;a+="00"}else{var c=s.toString(16);a+=2>c.length?"0"+c:c}}var i="0x";return r&&(i=""),i+a}function Re(e,t){var r="0x";return t&&(r=""),ke(e)?r+e.toString("hex"):Ae(e,t)}function Ke(e){return ve(function(e,t){var r="",n=0;for("0x"===e.substring(0,2)&&(n=2);e.length>n;n+=2){var a=parseInt(e.substr(n,2),16);if(t&&0===a)break;r+=String.fromCharCode(a)}return r}(e))}function Ae(e,t){return"boolean"==typeof e?Be(+e,t):we(e)?Be(e,t):"object"===n(e)?Ie(JSON.stringify(e),!1,t):be(e)?0===e.indexOf("-0x")?function(e,t){return Be(e,t)}(e,t):0===e.indexOf("0x")?e:Ie(e,1,t):Be(e,t)}function Oe(e){var t=Pe(e).round();return t.lessThan(0)?new f("ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff",16).plus(t).plus(1):t}function De(e){var t=e;return be(t)?("0x"===t.substr(0,2)&&(t=t.substr(2)),g.from(t,"hex")):t}function Le(e){return e.readInt32BE(0)}function We(e){return k(e)}function Ue(e,t){return Re(We(e),t)}function ze(e){return _(e)}function Me(e,t,r){this.tag=t,g.isBuffer(e)?this.encode(e,t,r):e&&this.decode(e.toString("ascii").trim(),r)}Me.prototype.toString=function(){return this.pem},Me.prototype.toBuffer=function(){return this.buf},Me.prototype.decode=function(e,t){e&&(this.pem=e.toString("ascii").trim());var r,n=this.pem.split(/\r?\n/),a=n[0].match(/\-\-\-\-\-\s*BEGIN ?([^-]+)?\-\-\-\-\-/);if(!a)throw Error("parse PEM: BEGIN not found");if(this.tag=a[1],n.shift(),"Proc-Type: 4,ENCRYPTED"===n[0]){if("string"!=typeof t)throw Error("PEM is encrypted but no passphrase given");r=n[1].match(/DEK-Info: ([^,]+),([0-9A-F]+)/i),n.splice(0,3);var o=r[1].toLowerCase(),s=g(r[2],"hex"),c=function(e,t,r){var n=r,a=Fe[e];if(!a){throw new TypeError("Unsupported type. Allowed: "+Object.keys(Fe))}var o=n.length,s=8;n.length!==s&&(n=n.slice(0,s));var c,i=16,u=!1,p=new g(a),f=0;for(;;){var h=new b;u?h.update(c):u=!0,h.update(t),h.update(n),c=h.digest();for(var y=0;a&&i>y;)p[f++]=c[y],a--,y++;var l=Math.min(o,i-y);if(o-=l,y+=l,0==a&&0==o)break}return p}
/**
 * @fileOverview
 * @name base64x-1.1.js
 * @author Kenji Urushima kenji.urushima@gmail.com
 * @version jsrsasign 8.0.12 base64x 1.1.14 (2018-Apr-22)
 * @since jsrsasign 2.1
 * @license <a href="https://kjur.github.io/jsrsasign/license/">MIT License</a>
 */(o.toUpperCase(),t,s);n.pop();var i=n.join("").toString("hex"),u=h.Hex.parse(c.toString("hex")),p=l.decrypt(i,u,{iv:h.Hex.parse(s.toString("hex")),padding:d.NoPadding,mode:m.CBC});r&&(this.buf=g(p.toString(h.Hex),"hex"))}return this.pem="-----BEGIN"+(this.tag?" "+this.tag:"")+"-----\n"+g(this.buf).toString("base64").match(/.{1,64}/g).join("\n")+"\n-----END"+(this.tag?" "+this.tag:"")+"-----",this.pem};var Fe={"DES-EDE3-CBC":24,"DES-CBC":8,"AES-128-CBC":16,"AES-192-CBC":24,"AES-256-CBC":32};function je(e,t){return"-----BEGIN "+t+"-----\r\n"+function(e){return function(e){var t,r,n="";for(t=0;e.length>=t+3;t+=3)r=parseInt(e.substring(t,t+3),16),n+=He.charAt(r>>6)+He.charAt(63&r);for(t+1==e.length?(r=parseInt(e.substring(t,t+1),16),n+=He.charAt(r<<2)):t+2==e.length&&(r=parseInt(e.substring(t,t+2),16),n+=He.charAt(r>>2)+He.charAt((3&r)<<4));(3&n.length)>0;)n+="=";return n}(e)}
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */(e).replace(/(.{64})/g,"$1\r\n").replace(/\r\n$/,"")+"\r\n-----END "+t+"-----\r\n"}var He="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var Qe=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function Ve(e){if(e>65536)throw Error("requested too many random bytes");var t=g.allocUnsafe(e);return e>0&&function(e){for(var t=e.length,r=0;t>r;r++)e[r]="0x"+Qe[parseInt(16*Math.random())]+Qe[parseInt(16*Math.random())]}(t),t}var Ye=new S("secp256k1"),Je=Buffer.from("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141","hex"),Ge=Buffer.alloc(32,0);function $e(e,t){if(!e)throw Error(t||"Assertion failed")}function Xe(e){return t=e,!(!Buffer.isBuffer(t)||32!==t.length)&&(e.compare(Ge)>0&&0>e.compare(Je));var t}function Ze(e){return Buffer.from(Ve(e))}function et(e,t,r){if(!t||!r)throw Error("aes empty key or iv!");var n=C("aes-128-gcm",t,r);n.setAutoPadding(!1);var a=n.update(e).toString("hex");return n.final(),{data:a,authTag:n.getAuthTag().toString("hex")}}function tt(e){var t=E("sha256").update(e).digest();return new Uint8Array(t)}function rt(e){return $e(32===e.length,"Bad private key"),$e(Xe(e),"Bad private key"),Buffer.from(Ye.keyFromPrivate(e).getPublic("arr"))}function nt(e,t){$e(Buffer.isBuffer(e),"Bad private key"),$e(Buffer.isBuffer(t),"Bad public key"),$e(32===e.length,"Bad private key"),$e(Xe(e),"Bad private key"),$e(65===t.length||33===t.length,"Bad public key"),65===t.length&&$e(4===t[0],"Bad public key"),33===t.length&&$e(2===t[0]||3===t[0],"Bad public key");var r=Ye.keyFromPrivate(e),n=Ye.keyFromPublic(t),a=r.derive(n.getPublic());return Buffer.from(a.toArray())}var at="02",ot={prime256v1:32,secp256k1:32,secp384r1:48,secp521r1:66},st={prime256v1:"P-256",secp256k1:"P-256K",secp384r1:"P-384",secp521r1:"P-521"},ct={"P-256":"prime256v1","P-256K":"secp256k1","P-384":"secp384r1","P-521":"secp521r1"},it=P("Rfc5915Key",(function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).objid({"1 2 840 10045 3 1 7":"prime256v1","1 3 132 0 10":"secp256k1","1 3 132 0 34":"secp384r1","1 3 132 0 35":"secp521r1"}),this.key("publicKey").optional().explicit(1).bitstr())})),ut=P("Pkcs8Key",(function(){this.seq().obj(this.key("version").int(),this.key("algorithmIdentifier").seq().obj(this.key("privateKeyType").objid({"1 2 840 10045 2 1":"EC"}),this.key("parameters").objid({"1 2 840 10045 3 1 7":"prime256v1","1 3 132 0 10":"secp256k1","1 3 132 0 34":"secp384r1","1 3 132 0 35":"secp521r1"})),this.key("privateKey").octstr())})),pt=P("SpkiKey",(function(){this.seq().obj(this.key("algorithmIdentifier").seq().obj(this.key("publicKeyType").objid({"1 2 840 10045 2 1":"EC"}),this.key("parameters").objid({"1 2 840 10045 3 1 7":"prime256v1","1 3 132 0 10":"secp256k1","1 3 132 0 34":"secp384r1","1 3 132 0 35":"secp521r1"})),this.key("publicKey").bitstr())}));function ft(e,t){var r=ot[e];if(4==t[0]){if(t.length!=2*r+1)throw new TypeError("Invalid uncompressed key size");return{c:e,x:t.slice(1,r+1),y:t.slice(r+1)}}throw new TypeError("Compressed key unsupported")}function ht(e){var t=ut.decode(e,"der"),r=it.decode(t.privateKey,"der"),n=t.algorithmIdentifier.parameters,a=ot[n],o=r.privateKey;if(o.length>a)throw new TypeError("Invalid private key size: expected "+a+" gotten "+o.length);var s=ft(n,r.publicKey.data);return s.d=o,s}function yt(e){var t=pt.decode(e,"der");return ft(t.algorithmIdentifier.parameters,t.publicKey.data)}var lt=/-+BEGIN EC PRIVATE KEY-+([\s\S]+)-+END EC PRIVATE KEY-+/m,dt=/-+BEGIN PRIVATE KEY-+([\s\S]*)-+END PRIVATE KEY-+/m,mt=/-+BEGIN PUBLIC KEY-+([\s\S]*)-+END PUBLIC KEY-+/m;function vt(e){if("string"!=typeof e)throw new TypeError("PEM must be a string");var t=null;if(t=e.match(lt))return function(e){var t=it.decode(e,"der"),r=ot[t.parameters],n=t.privateKey;if(n.length>r)throw new TypeError("Invalid private key size: expected "+r+" gotten "+n.length);var a=ft(t.parameters,t.publicKey.data);return a.d=n,a}(new g(t[1].replace(/[\s-]/gm,""),"base64"));if(t=e.match(dt))return ht(new g(t[1].replace(/[\s-]/gm,""),"base64"));if(t=e.match(mt))return yt(new g(t[1].replace(/[\s-]/gm,""),"base64"));throw new TypeError("Unrecognized PEM key structure")}function gt(e,t){if(!(this instanceof gt))return new gt(e,t);var r,n,a,o,s;if(t||(t="pem"),g.isBuffer(e))if("pem"==t)r=(c=vt(e.toString("ascii"))).c,a=c.x,o=c.y,n=c.d;else if("pkcs8"==t||"rfc5208"==t){r=(c=ht(e)).c,a=c.x,o=c.y,n=c.d}else{if("spki"!=t&&"rfc5280"!=t)throw new TypeError('Unknown format for EC Key "'+t+'"');r=(c=yt(e)).c,a=c.x,o=c.y,n=c.d}else if("string"==typeof e){if("pem"==t)r=(c=vt(e)).c,a=c.x,o=c.y,n=c.d;else if("pkcs8"==t||"rfc5208"==t){r=(c=ht(new g(e,"base64"))).c,a=c.x,o=c.y,n=c.d}else{if("spki"!=t&&"rfc5280"!=t)throw new TypeError('Unknown format for EC Key "'+t+'"');r=(c=yt(new g(e,"base64"))).c,a=c.x,o=c.y,n=c.d}}else{if(!(s=e)||s.constructor!==Object)throw new TypeError("Unrecognized format for EC key");if("string"==typeof e.curve?r=e.curve:"string"==typeof e.crv&&(r=ct[e.crv]||e.crv),g.isBuffer(e.privateKey)?n=e.privateKey:"string"==typeof e.privateKey?n=new g(e.privateKey,"base64"):g.isBuffer(e.d)?n=e.d:"string"==typeof e.d&&(n=new g(e.d,"base64")),g.isBuffer(e.publicKey)){var c=ft(r,e.publicKey);a=c.x,o=c.y}else if("string"==typeof e.publicKey){c=ft(r,new g(e.publicKey,"base64"));a=c.x,o=c.y}else g.isBuffer(e.x)?a=e.x:"string"==typeof e.x&&(a=new g(e.x,"base64")),g.isBuffer(e.y)?o=e.y:"string"==typeof e.y&&(o=new g(e.y,"base64"))}if(!r)throw new TypeError("EC Key curve not specified");if(!a||!o)throw new TypeError("Public EC Key point unavailable");var i=ot[r];if(!i)throw new TypeError('EC Key curve "'+r+'" invalid');if(a.length!=i)throw new TypeError("Public EC Key point X of wrong length");if(o.length!=i)throw new TypeError("Public EC Key point Y of wrong length");if(n&&o.length!=i)throw new TypeError("Private EC Key of wrong length");Object.defineProperties(this,{curve:{enumerable:!0,configurable:!1,value:r},isPrivateECKey:{enumerable:!0,configurable:!1,value:null!=n},x:{enumerable:!0,configurable:!1,get:function(){return new g(a)}},y:{enumerable:!0,configurable:!1,get:function(){return new g(o)}},jsonCurve:{enumerable:!1,configurable:!1,value:st[r]},publicCodePoint:{enumerable:!1,configurable:!1,get:function(){return g.concat([new g([4]),a,o])}}}),n&&Object.defineProperty(this,"d",{enumerable:!0,configurable:!1,get:function(){return new g(n)}})}function _t(e,t){return function(e,t){var r=new gt(function(e,t,r){return new Me(e,t,r)}(e,"EC PRIVATE KEY",t).pem,"pem"),n=r.d,a=r.publicCodePoint;a.length>64&&(a=a.slice(1));return{privateKey:n,publicKey:a}}(e,t)}function kt(e,t){var r=e;ke(r)?32!==r.length&&(r=qe(_e(r))):r=be(r)&&0===r.indexOf("0x")?qe(r):qe(_e(r));var n=w(r,t);return g.concat([n.signature,g.from([n.recovery])],65)}function wt(e,t){var r=e,n=t;if(!r||!n)throw Error("aes password or tx hash is invalid"+r+"..."+n);if(be(r)&&(r="0x"===r.substr(0,2)?g.from(r.substr(2),"hex"):g.from(r,"ascii")),!ke(r))throw Error("aes password is invalid");return n=De(n),E("sha256").update(g.concat([r,n])).digest().slice(0,16)}function bt(){return Ve(4).readUInt32BE(0)}function xt(e,t,r,n,a){return a===at?function(e,t,r){var n=r,a=e;if(!a)throw Error("ecc_pub_key is invalid");n||(n=Ve(16));n=De(n);var o=Ve(12),s=Ct(t,n,o),c=g.from(s.authTag,"hex"),i=g.from(s.data,"hex"),u={iv:o},p=T.formatter.pemToBin(""+a),f=g.from(p),h=function(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.ephemPrivateKey||Ze(32);!Xe(n);)n=r.ephemPrivateKey||Ze(32);var a=rt(n),o=nt(n,e),s=Buffer.alloc(36);o.copy(s,0,0,32),s[35]=1;var c=tt(s),i=r.iv||Ze(12),u=Buffer.from(c.slice(0,16)),p=et(t,u,i),f=De(p.data),h=De(p.authTag);return Buffer.concat([a,i,h,f])}(a=De(a=f.slice(f.byteLength-65,f.byteLength)),n,u);if(109>h.length){var y=g.alloc(109);h.copy(y,109-h.length),h=y}var l=new g(2);return l.writeUInt16BE(320,0),h=De(h),"0x"+g.concat([l,h,o,c,i]).toString("hex")}(e,t,wt(r,n)):function(e,t,r){var n=r,a=e;n||(n=Ve(16));if(n=De(n),!a)throw Error("rsa_pub_key is invalid");be(a)&&-1===a.indexOf("PUBLIC KEY")&&("0x"===a.substr(0,2)&&(a=a.substr(2)),a=je(a,"PUBLIC KEY"));var o=Ve(12),s=Ct(t,n,o),c=x.publicEncrypt(a,n);if(256>c.length){var i=g.alloc(256);c.copy(i,256-c.length),c=i}var u=new g(2);return u.writeUInt16BE(1,0),"0x"+g.concat([u,c,o,g.from(s.authTag,"hex"),g.from(s.data,"hex")]).toString("hex")}(e,t,wt(r,n))}function Ct(e,t,r){if(!t||!r)throw Error("aes empty key or iv!");var n=e,a=t;n=De(n),a=De(a);var o=C("aes-128-gcm",a,r);o.setAutoPadding(!1);var s=o.update(n).toString("hex");return o.final(),{data:s,authTag:o.getAuthTag().toString("hex")}}function qt(e,t,r){return function(e,t){if(!t||!e)throw Error("aes empty key or data!");var r=e,n=t;r=De(r),n=De(n);var a=r.length-16,o=r.length,s=r.slice(a,o),c=r.slice(a-=12,o-=16),i=r.slice(0,a),u=q("aes-128-gcm",n,c);return u.setAuthTag(s),"0x"+u.update(i).toString("hex")}(e,wt(t,r))}function Et(e,t){if(-1!==e.name.indexOf("("))return e.name;var r="";return r=t?t.join(","):e.inputs.map((function(e){return e.type})).join(","),e.name+"("+r+")"}gt.prototype.asPublicECKey=function(){return this.isPrivateECKey?new gt({curve:this.curve,x:this.x,y:this.y}):this},gt.prototype.toBuffer=function(e){if(e||(e="pem"),"pem"==e)return new g(this.toString("pem"),"ascii");if(this.isPrivateECKey){for(var t=this.d;0==t[0];)t=t.slice(1);if("pkcs8"==e||"rfc5208"==e)return ut.encode({version:0,algorithmIdentifier:{privateKeyType:"EC",parameters:this.curve},privateKey:it.encode({version:1,privateKey:t,publicKey:{data:this.publicCodePoint}},"der")},"der");if("rfc5915"==e)return it.encode({version:1,privateKey:t,parameters:this.curve,publicKey:{data:this.publicCodePoint}},"der");throw new TypeError('Unknown format for private key "'+e+'"')}if("spki"==e||"rfc5280"==e)return pt.encode({algorithmIdentifier:{publicKeyType:"EC",parameters:this.curve},publicKey:{data:this.publicCodePoint}},"der");throw new TypeError('Unknown format for public key "'+e+'"')},gt.prototype.toString=function(e){if(e||(e="pem"),this.isPrivateECKey){if("pem"==e)return"-----BEGIN PRIVATE KEY-----\n"+this.toBuffer("pkcs8").toString("base64").match(/.{1,64}/g).join("\n")+"\n-----END PRIVATE KEY-----\n";if("rfc5915"==e)return"-----BEGIN EC PRIVATE KEY-----\n"+this.toBuffer("rfc5915").toString("base64").match(/.{1,64}/g).join("\n")+"\n-----END EC PRIVATE KEY-----\n";if("pkcs8"==e||"rfc5208"==e)return this.toBuffer("pkcs8").toString("base64");if("spki"==e||"rfc5280"==e)return this.toBuffer("spki").toString("base64");throw new TypeError('Unknown format for private key "'+e+'"')}if("pem"==e)return"-----BEGIN PUBLIC KEY-----\n"+this.toBuffer("spki").toString("base64").match(/.{1,64}/g).join("\n")+"\n-----END PUBLIC KEY-----\n";if("spki"==e||"rfc5280"==e)return this.toBuffer("spki").toString("base64");throw new TypeError('Unknown format for public key "'+e+'"')},gt.prototype.toJSON=function(){function e(e){return e.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}var t={kty:"EC",crv:st[this.curve],x:e(this.x),y:e(this.y)},r=this.d;if(r){var n=ot[this.curve];if(n>r.length)r=g.concat([new g(n-r.length).fill(0),r]);t.d=e(r)}return t};var Tt=function(e,t){this.value=e||"",this.offset=t};Tt.prototype.dynamicPartLength=function(){return this.dynamicPart().length/2},Tt.prototype.withOffset=function(e){return new Tt(this.value,e)},Tt.prototype.combine=function(e){return new Tt(this.value+e.value)},Tt.prototype.isDynamic=function(){return void 0!==this.offset},Tt.prototype.offsetAsBytes=function(){return this.isDynamic()?Ee(Oe(this.offset).toString(16),64):""},Tt.prototype.staticPart=function(){return this.isDynamic()?this.offsetAsBytes():this.value},Tt.prototype.dynamicPart=function(){return this.isDynamic()?this.value:""},Tt.prototype.encode=function(){return this.staticPart()+this.dynamicPart()},Tt.encodeList=function(e){var t=32*e.length,r=e.map((function(e){if(!e.isDynamic())return e;var r=t;return t+=e.dynamicPartLength(),e.withOffset(r)}));return r.reduce((function(e,t){return e+t.dynamicPart()}),r.reduce((function(e,t){return e+t.staticPart()}),""))};var St=function(e){f.config({ROUNDING_MODE:f.ROUND_DOWN});var t=Ee(Oe(e).toString(16),64);return new Tt(t)},Pt=function(e){var t=Ae(e).substr(2);return t=Se(t,64*Math.floor((t.length+63)/64)),new Tt(t)},Nt=function(e){var t=Ae(e).substr(2);t.length%2!=0&&(t="0"+t);var r=t.length/2;return t=Se(t,64*Math.floor((t.length+63)/64)),new Tt(St(r).value+t)},Bt=function(e){var t,r,n=(t=e,Ie(t,r)).substr(2),a=n.length/2;return n=Se(n,64*Math.floor((n.length+63)/64)),new Tt(St(a).value+n)},It=function(e){return new Tt("000000000000000000000000000000000000000000000000000000000000000"+(e?"1":"0"))},Rt=function(e){return St(new f(e).times(new f(2).pow(128)))},Kt=function(e){var t=e.staticPart()||"0";return function(e){return"1"===new f(e.substr(0,1),16).toString(2).substr(0,1)}(t)?new f(t,16).minus(new f("ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff",16)).minus(1):new f(t,16)},At=function(e){var t=e.staticPart()||"0";return new f(t,16)},Ot=function(e){return Kt(e).dividedBy(new f(2).pow(128))},Dt=function(e){return At(e).dividedBy(new f(2).pow(128))},Lt=function(e){return"0000000000000000000000000000000000000000000000000000000000000001"===e.staticPart()},Wt=function(e,t){var r=t.match(/^bytes([0-9]*)/),n=parseInt(r[1]);return"0x"+e.staticPart().slice(0,2*n)},Ut=function(e){var t=2*new f(e.dynamicPart().slice(0,64),16).toNumber();return"0x"+e.dynamicPart().substr(64,t)},zt=function(e){var t=2*new f(e.dynamicPart().slice(0,64),16).toNumber();return Ke(e.dynamicPart().substr(64,t))},Mt=function(e){var t=e.staticPart();return"0x"+t.slice(t.length-40,t.length)},Ft=function(e){return"0x"+e.staticPart()},jt=function(e){this._inputFormatter=e.inputFormatter,this._outputFormatter=e.outputFormatter};jt.prototype.isType=function(e){throw"this method should be overrwritten for type "+e},jt.prototype.staticPartLength=function(e){return(this.nestedTypes(e)||["[1]"]).map((function(e){return parseInt(e.slice(1,-1),10)||1})).reduce((function(e,t){return e*t}),32)},jt.prototype.isDynamicArray=function(e){var t=this.nestedTypes(e);return!!t&&!t[t.length-1].match(/[0-9]{1,}/g)},jt.prototype.isStaticArray=function(e){var t=this.nestedTypes(e);return!!t&&!!t[t.length-1].match(/[0-9]{1,}/g)},jt.prototype.staticArrayLength=function(e){var t=this.nestedTypes(e);return t?parseInt(t[t.length-1].match(/[0-9]{1,}/g)||1):1},jt.prototype.nestedName=function(e){var t=this.nestedTypes(e);return t?e.substr(0,e.length-t[t.length-1].length):e},jt.prototype.isDynamicType=function(){return!1},jt.prototype.nestedTypes=function(e){return e.match(/(\[[0-9]*\])/g)},jt.prototype.encode=function(e,t){var r=this;return this.isDynamicArray(t)?function(){var n=e.length,a=r.nestedName(t),o=[];return o.push(St(n).encode()),e.forEach((function(e){o.push(r.encode(e,a))})),o}():this.isStaticArray(t)?function(){for(var n=r.staticArrayLength(t),a=r.nestedName(t),o=[],s=0;n>s;s++)o.push(r.encode(e[s],a));return o}():this._inputFormatter(e,t).encode()},jt.prototype.decode=function(e,t,r){var n=this;if(this.isDynamicArray(r))return function(){for(var a=parseInt("0x"+e.substr(2*t,64)),o=parseInt("0x"+e.substr(2*a,64)),s=a+32,c=n.nestedName(r),i=n.staticPartLength(c),u=32*Math.floor((i+31)/32),p=[],f=0;o*u>f;f+=u)p.push(n.decode(e,s+f,c));return p}();if(this.isStaticArray(r))return function(){for(var a=n.staticArrayLength(r),o=t,s=n.nestedName(r),c=n.staticPartLength(s),i=32*Math.floor((c+31)/32),u=[],p=0;a*i>p;p+=i)u.push(n.decode(e,o+p,s));return u}();if(this.isDynamicType(r))return function(){var a=parseInt("0x"+e.substr(2*t,64)),o=parseInt("0x"+e.substr(2*a,64)),s=new Tt(e.substr(2*a,64*(1+Math.floor((o+31)/32))),0);return n._outputFormatter(s,r)}();var a=this.staticPartLength(r),o=new Tt(e.substr(2*t,2*a));return this._outputFormatter(o,r)};var Ht=function(){this._inputFormatter=St,this._outputFormatter=Mt};(Ht.prototype=new jt({})).constructor=Ht,Ht.prototype.isType=function(e){return!!e.match(/address(\[([0-9]*)\])?/)};var Qt=function(){this._inputFormatter=St,this._outputFormatter=Ft};(Qt.prototype=new jt({})).constructor=Qt,Qt.prototype.isType=function(e){return!!e.match(/^identity(\[([0-9]*)\])*$/)};var Vt=function(){this._inputFormatter=It,this._outputFormatter=Lt};(Vt.prototype=new jt({})).constructor=Vt,Vt.prototype.isType=function(e){return!!e.match(/^bool(\[([0-9]*)\])*$/)};var Yt=function(){this._inputFormatter=St,this._outputFormatter=Kt};(Yt.prototype=new jt({})).constructor=Yt,Yt.prototype.isType=function(e){return!!e.match(/^int([0-9]*)?(\[([0-9]*)\])*$/)};var Jt=function(){this._inputFormatter=St,this._outputFormatter=At};(Jt.prototype=new jt({})).constructor=Jt,Jt.prototype.isType=function(e){return!!e.match(/^uint([0-9]*)?(\[([0-9]*)\])*$/)};var Gt=function(){this._inputFormatter=Nt,this._outputFormatter=Ut};(Gt.prototype=new jt({})).constructor=Gt,Gt.prototype.isType=function(e){return!!e.match(/^bytes(\[([0-9]*)\])*$/)},Gt.prototype.isDynamicType=function(){return!0};var $t=function(){this._inputFormatter=Bt,this._outputFormatter=zt};($t.prototype=new jt({})).constructor=$t,$t.prototype.isType=function(e){return!!e.match(/^string(\[([0-9]*)\])*$/)},$t.prototype.isDynamicType=function(){return!0};var Xt=function(){this._inputFormatter=Rt,this._outputFormatter=Ot};(Xt.prototype=new jt({})).constructor=Xt,Xt.prototype.isType=function(e){return!!e.match(/real([0-9]*)?(\[([0-9]*)\])?/)};var Zt=function(){this._inputFormatter=Rt,this._outputFormatter=Dt};(Zt.prototype=new jt({})).constructor=Zt,Zt.prototype.isType=function(e){return!!e.match(/^ureal([0-9]*)?(\[([0-9]*)\])*$/)};var er=function(){this._inputFormatter=Pt,this._outputFormatter=Wt};(er.prototype=new jt({})).constructor=er,er.prototype.isType=function(e){return!!e.match(/^bytes([0-9]{1,})(\[([0-9]*)\])*$/)};var tr=function(e,t){return e.isDynamicType(t)||e.isDynamicArray(t)},rr=function(e){this._types=e};rr.prototype._requireType=function(e){var t=this._types.filter((function(t){return t.isType(e)}))[0];if(!t)throw Error("invalid solidity type!: "+e);return t},rr.prototype.encodeParam=function(e,t){return this.encodeParams([e],[t])},rr.prototype.encodeParams=function(e,t){var r=this.getSolidityTypes(e),n=r.map((function(r,n){return r.encode(t[n],e[n])})),a=r.reduce((function(t,n,a){var o=n.staticPartLength(e[a]),s=32*Math.floor((o+31)/32);return t+(tr(r[a],e[a])?32:s)}),0);return this.encodeMultiWithOffset(e,r,n,a)},rr.prototype.encodeMultiWithOffset=function(e,t,r,n){var a="",o=this;return e.forEach((function(s,c){if(tr(t[c],e[c])){a+=St(n).encode();var i=o.encodeWithOffset(e[c],t[c],r[c],n);n+=i.length/2}else a+=o.encodeWithOffset(e[c],t[c],r[c],n)})),e.forEach((function(s,c){if(tr(t[c],e[c])){var i=o.encodeWithOffset(e[c],t[c],r[c],n);n+=i.length/2,a+=i}})),a},rr.prototype.encodeWithOffset=function(e,t,r,n){var a=1,o=2,s=3,c=t.isDynamicArray(e)?a:t.isStaticArray(e)?o:s;if(c!==s){var i=t.nestedName(e),u=t.staticPartLength(i),p=c===a?r[0]:"";if(t.isDynamicArray(i))for(var f=c===a?2:0,h=0;r.length>h;h++)c===a?f+=+r[h-1][0]||0:c===o&&(f+=+(r[h-1]||[])[0]||0),p+=St(n+h*u+32*f).encode();for(var y=c===a?r.length-1:r.length,l=0;y>l;l++){var d=p/2;c===a?p+=this.encodeWithOffset(i,t,r[l+1],n+d):c===o&&(p+=this.encodeWithOffset(i,t,r[l],n+d))}return p}return r},rr.prototype.decodeParam=function(e,t){return this.decodeParams([e],t)[0]},rr.prototype.decodeParams=function(e,t){var r=this.getSolidityTypes(e),n=this.getOffsets(e,r);return r.map((function(r,a){return r.decode(t,n[a],e[a],a)}))},rr.prototype.getOffsets=function(e,t){for(var r=t.map((function(t,r){return t.staticPartLength(e[r])})),n=1;r.length>n;n++)r[n]+=r[n-1];return r.map((function(r,n){return r-t[n].staticPartLength(e[n])}))},rr.prototype.getSolidityTypes=function(e){var t=this;return e.map((function(e){return t._requireType(e)}))};var nr,ar=new rr([new Ht,new Qt,new Vt,new Yt,new Jt,new Gt,new er,new $t,new Xt,new Zt]);!function(e){e.CONNECTION="connection",e.RESPONSE_NOT_JSON="responseNotJSON",e.RETURNCODE_ERROR="returnCode",e.RECEIPT_ERROR="receiptResult"}(nr||(nr={}));var or=function(e){c(r,u(Error));var t=i(r);function r(e,n){var o;return a(this,r),(o=t.call(this,e)).type=void 0,o.code=void 0,o.returnCode=void 0,o.receiptCode=void 0,o.hash=void 0,o.output=void 0,n&&(o.type=n.type,o.code=n.code,o.returnCode=n.returnCode,o.receiptCode=n.receiptCode,o.hash=n.hash,o.output=n.output),o}return o(r)}(),sr=function(){return new or("Invalid number of arguments to Solidity function")},cr=function(){return new or("CONNECTION UNAUTHORIZED")},ir=function(e){return new or("PARAMETER ERROR: The value of "+e+" is error")};function ur(e){var t=e;return ke(t)&&(t=t.toString("hex")),t?"0x"+t:""}var pr=Object.freeze({__proto__:null,inputdecimal:function(e){return Ne(e)},inputhash:function e(t){if(be(t)){if(0===t.indexOf("0x")){if(66===t.length)return t;if(66>t.length)return"0x"+Te(Ae(t).slice(2),64)}return _e(t)}if(ke(t))return Re(t);if(Ce(t)){for(var r=[],n=0;t.length>n;n++)r[n]=e(t[n]);return r}return"0x"+Te(Ae(t).slice(2),64)},inputbytes:function(e){return ke(e)?Re(e):be(e)&&0===e.indexOf("0x")?e:Ae(e)},inputcode:function(e,t,r){var n=t,a=r;n||(n="01"),a||(a="");var o="",s="",c=0;if(ke(e)?(c=e.length,o=e.toString("hex")):be(e)&&(0===(o=e).indexOf("0x")&&(o=o.slice(2)),c=o.length/2),"wasm"===n){n="02";var i=new Buffer(4);i.writeUInt32BE(c),s=i.toString("hex")}if(""===o)throw ir("code");return"0x"+n+s+o+a},inputbignumber:function(e){return N.isBN(e)?e:be(e)&&0===e.indexOf("0x")?new N(e.slice(2),16):new N(e,10)},outputdecimal:function(e,t){var r=e;return ke(r)&&(r=r.toString("hex")),Ne(r,t)},outputbytes:ur,outputhash:function(e){return ur(e)},outputstring:function(e){var t=e;return ke(t)&&(t=t.toString("hex")),Ke(t)},outputbignumber:function(e){var t=e;return"number"==typeof t?t:ke(t)?new N(t=t.toString("hex"),16).toNumber():be(t)&&0===t.indexOf("0x")?new N(t.slice(2),16).toNumber():new N(t).toNumber()}}),fr=[[{name:"session_id"}]],hr={name:"hash",type:"hash"},yr=Array(hr);yr.value=[],yr.name="hashes",yr.type="array";var lr=[{name:"key",type:"bytes"},{name:"value",type:"bytes"}];lr.name="configs",lr.type="array";var dr={name:"timestamp",type:"decimal"},mr={name:"from",type:"hash"},vr={name:"to",type:"hash"},gr={name:"gas_used",type:"decimal"},_r={name:"identity",type:"hash"},kr={name:"transaction_index",type:"decimal"},wr={name:"topic",type:"string"},br={name:"msg_type",type:"decimal"},xr={name:"sequence",type:"decimal"},Cr={name:"group_id",type:"bytes"},qr={name:"return_code",type:"decimal"},Er=[br],Tr=[Er,xr,Cr],Sr=[Er,xr,qr,Cr],Pr={name:"block_number",type:"bignumber"},Nr=[wr];Nr.name="topics",Nr.type="array",Nr.array_type="one";var Br=[mr,vr,Nr,{name:"log_data",type:"bytes"}];Br.name="log_entry",Br.value=[],Br.type="array";var Ir=[{name:"result",type:"decimal"},gr,Br,{name:"output",type:"bytes"}];Ir.name="receipt";var Rr=[Ir];Rr.name="receipts",Rr.type="array";var Kr={name:"transaction_type",type:"decimal"},Ar={name:"nonce"},Or={name:"period",type:"decimal"},Dr={name:"value",type:"decimal"},Lr={name:"gas",type:"decimal"},Wr={name:"version",type:"decimal",value:2},Ur=[];Ur.name="extensions",Ur.type="array";var zr={name:"data",type:"bytes"},Mr=[{name:"signature",type:"bytes"}];Mr.name="signature",Mr.type="array",Mr.array_type="one";var Fr=[hr,Kr,dr,Ar,Or,mr,vr,Dr,Lr,Cr,Wr,zr,Mr,Ur];Fr.name="transaction";var jr=[hr,Kr,dr,Ar,Or,mr,vr,Dr,Lr,Cr,Wr,zr,Mr,Ur];jr.name="transactions",jr.type="array";var Hr=[Fr,Ir,Pr,kr];Hr.name="transaction_infos",Hr.type="array";var Qr=B(Fr);Qr.type="array",Qr.value=[],Qr.name="transaction_list";var Vr=B(Ir);Vr.type="array",Vr.value=[],Vr.name="receipt_list";var Yr=[hr,{name:"version",type:"decimal"},Pr,{name:"parent_hash",type:"hash"},{name:"transaction_root",type:"bytes"},{name:"receipt_root",type:"bytes"},{name:"state_root",type:"bytes"},gr,dr,{name:"log_bloom",type:"bytes"}];Yr.name="block_header";var Jr=[Qr,Vr,{name:"consensus_proof",type:"bytes"}];Jr.name="block_body";var Gr=[Yr,Jr];Gr.name="block";var $r={name:"balance",value:"",type:"decimal"},Xr={name:"recover_key",type:"bytes"},Zr={name:"recover_time",type:"decimal"},en={name:"status",type:"decimal"},tn={name:"code",type:"bytes"},rn={name:"storage_root",type:"bytes"},nn={name:"code_hash",type:"hash"},an={name:"encryption_key",type:"bytes"},on={name:"auth_key",type:"bytes"},sn={name:"auth_weight",type:"decimal"},cn=[on,sn];cn.name="auth_map",cn.type="array",cn.array_type=2,cn.rlp=!0,cn.mapInfo={key:on,value:sn};var un=[_r,$r,Xr,Zr,en,tn,rn,nn,an,[{name:"acc_version",type:"decimal",value:2}],cn],pn=[_r,$r,Xr,Zr,en,tn,rn,nn,an,on,sn];un.name="data";var fn=un,hn={name:"node_id",type:"bytes",value:"0x00"},yn={name:"public_key",type:"bytes"},ln={name:"node_role",type:"decimal"},dn={name:"node_state",type:"decimal"},mn=[{name:"ip",type:"string"},{name:"port",type:"decimal"}];mn.name="endpoints",mn.type="array";var vn=[[hn,yn,ln,dn,mn],{name:"isConnected",type:"decimal"}];vn.name="node_status",vn.type="array";var gn=[{name:"total_node_count",type:"decimal"},{name:"total_consensus_node_count",type:"decimal"},{name:"total_non_consensus_node_count",type:"decimal"},{name:"total_connected_consensus_node_count",type:"decimal"},{name:"total_connected_non_consensus_node_count",type:"decimal"},vn];gn.name="p2p_status";var _n=[hn,yn,ln,dn,mn];_n.name="node_info",_n.type="array";var kn=[{name:"syncing",type:"decimal"},{name:"my_best",type:"decimal"},{name:"target",type:"decimal"}];kn.name="sync_status";var wn={name:"unverified_queue_limit",type:"decimal"},bn={name:"verified_queue_limit",type:"decimal"},xn={name:"unverified_queue_usage",type:"decimal"},Cn={name:"verified_queue_usage",type:"decimal"},qn=[wn,bn,xn,Cn];qn.name="transaction_cache_info";var En=[wn,bn,{name:"verified_parent_not_found_queue_limit",type:"decimal"},xn,Cn,{name:"verified_parent_not_found_queue_usage",type:"decimal"},{name:"unverified_max_block_number",type:"decimal"},{name:"verified_max_block_number",type:"decimal"},{name:"verified_parent_not_found_max_block_number",type:"decimal"}];En.name="block_cache_info";var Tn={name:"code",type:"bytes"},Sn={name:"type",type:"decimal",value:0},Pn={name:"filter_id",type:"decimal"},Nn=[{name:"type",type:"bytes"},{name:"phase",type:"string"},{name:"n",type:"decimal"},{name:"f",type:"decimal"},{name:"current_leader",type:"bytes"},{name:"my_id",type:"bytes"},{name:"current_view",type:"decimal"},{name:"last_exec_seq",type:"decimal"},{name:"propose_size",type:"decimal"},{name:"propose_timeout_interval",type:"decimal"},{name:"normal_timeout_interval",type:"decimal"},{name:"viewchange_timeout_interval",type:"decimal"}];Nn.name="info";var Bn=[{name:"black_list",type:"hash"}];Bn.name="black_list",Bn.type="array";var In=[{name:"type",type:"decimal"},{name:"proof",type:"bytes"}];In.name="block_proof_info";var Rn={name:"block_number",type:"decimal"},Kn=[{name:"data",type:"bytes"},{name:"next_key_begin_index",type:"decimal"},{name:"next_key_end_index",type:"decimal"}];Kn.name="nodes",Kn.type="array";var An=[Rn,{name:"state_root",type:"bytes"},Kn];An.name="proof";var On={name:"root",type:"bytes"},Dn={name:"index",type:"decimal"},Ln={name:"size",type:"decimal"},Wn={name:"branch",type:"decimal"},Un=[Rn,On,Dn,Ln,Wn];Un.name="proof";var zn=[Rn,On,Dn,Ln,Wn];zn.name="receipt_proof";var Mn=[In,Yr];Mn.name="header_infos",Mn.type="array";var Fn={name:"block_hash",type:"hash"},jn=[Fn,Rr];jn.name="block_receipts",jn.type="array";var Hn=[jr,Rr,{name:"consensus_proof",type:"bytes"}];Hn.name="body";var Qn=[Fn,Hn];Qn.name="block_body",Qn.type="array";var Vn=25,Yn=124,Jn="CreateAccount",Gn="QueryTransactionReceipt",$n="TransferBalance",Xn="SetRecoverkey",Zn="PreResetPubKey",ea="ResetPubKey",ta="UpdateAuthMap",ra="QueryLastBlock",na="QueryBlockHeader",aa="QueryLastBlockHeader",oa="QueryBlock",sa="QueryTransaction",ca="QueryAccount",ia="QueryContract",ua="DeployContract",pa="UpdateContract",fa="CallContract",ha="EncryptedTransaction",ya="EventContract",la="EventFetch",da={},ma={};function va(e,t){return be(e)&&"0x"===e.substr(0,2)&&66===e.length?t?e.substr(2):e:_e(e,t)}function ga(e,t){for(var r=[],n=0;e.length>n;n++){var a=e[n];if(!Array.isArray(a)||a.rlp){var o=t[a.name]||a.value||"",s=a.type;a.rlp&&(s="bytes");var c=pr["input"+s];c&&(o="code"===s&&t.type?c(o,t.type,t.parameters):c(o)),r[n]=o}else r[n]=ga(a,t)}return r}function _a(e,t){var r=ma[e];if(!r)throw Error(e+" is not api");return ga(r.data,t)}function ka(e,t,r){for(var n=[],a=0;r.length>a;a++){var o=r[a];if(!Array.isArray(o)||o.rlp){var s=o.name,c=t[s]||o.value||"";if("msg_type"===s)c=ma[e].request_msg_type;else if("transaction_type"===s)c=ma[e].transaction_type,e===Z.LocalTransaction&&(c=t.type);else{var i=o.type;o.rlp&&(i="bytes");var u=pr["input"+i];u&&(c=u(c))}n[a]=c}else n[a]=ka(e,t,o)}return n}function wa(e,t){te("RequestProcess ".concat(e),t);var r=ma[e];if(!r)throw Error(e+" is not api");return ka(e,t,r.request)}function ba(e,t){if(ke(t)){var r=pr["output"+e.type];return r?r(t):t.toString("hex")}return t||e.value||""}function xa(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=t.name,a=t.type,o=r;if(Array.isArray(t)&&e)if("array"===a&&Array.isArray(e)){var s=[];if("one"===t.array_type)e.forEach((function(e){s.push(ba(t[0],e))}));else if("number"==typeof t.array_type)for(var c=t.slice(0),i=0;e.length>i;i+=2)s.push(Ca([e[i],e[i+1]],c));else e.forEach((function(e){s.push(Ca(e,t))}));var u=n||"arr";o[u]=s}else if(t.rlp){var p=ze(e);o=xa(p,t,o)}else n?o[n]=Ca(e,t):o=Ca(e,t,o);else o[n]=ba(t,e);return o}function Ca(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r,a=0;t.length>a;a++){var o=(Array.isArray(e)?e[a]:e)||"",s=t[a];n=xa(o,s,n)}return n}function qa(e,t){switch(e){case ae.ACCOUNT:return function(e){return Ca(e,[[pn]])}(t);case ae.CONTRACT:return function(e){return Ca(e,[[un]])}(t);case ae.TOPICS:return function(e){return Ca(e,[[[wr,{name:"data",type:"bytes"}]]])}(t);case ae.BLOCK:return function(e){return Ca(e,[[Yr]])}(t)}}function Ea(e,t,r){var n=e;if(!n)throw Error("aes empty key or iv or tag!");var a=function(e,t){if(!t||!e)throw Error("aes empty key or data!");var r=e,n=t;r=De(r),n=De(n);var a=0,o=12,s=r.slice(a,o),c=r.slice(a+=12,o+=16),i=r.slice(a+=16,o=r.length),u=q("aes-128-gcm",n,s);return u.setAuthTag(c),"0x"+u.update(i).toString("hex")}((n=De(n)).slice(258,n.length),wt(t,r));return Ca(ze(a),Fr)}function Ta(e,t,r,n){var a=function(e){return ma[e].transaction_type}(e);te("[NEW JS SDK] getTxData:",t);var o={type:a,group_id:t.group_id||"0x0000000000000000000000000000000000000000",timestamp:Date.now(),nonce:t.nonce||bt(),period:t.period||100,from:t.from||r.from,to:t.to,value:t.value||0,gas:t.gas||1e10,version:t.tx_version||2,extensions:[],data:t.data};r.sequence&&(o.sequence=r.sequence);var s=t.hash||_e(Ue([o.type,o.timestamp,o.nonce,o.period,o.from,o.to,o.value,o.gas,o.group_id,o.version,o.data,o.extensions])),c=kt(s,n||r.userPrivateKey);return o.hash=s,o.signature=r.isSign?Re(c):"",te("[NEW JS SDK] getTxData return param:",o),o}function Sa(e,t,r,n){return{type:t.transaction_type,group_id:e.group_id||"0x0000000000000000000000000000000000000000",timestamp:r,nonce:e.nonce||bt(),period:e.period||100,from:"0x0",to:"0x0",value:e.value||0,gas:e.gas||1e7,version:e.tx_version||2,extensions:[],data:e.data||"0x0",sequence:t.sequence,hash:n,signature:"0x0"}}function Pa(e,t){return wa(e,t)}function Na(e,t,r){var n,a,o;if(r){te("[RestProvider] parseReceiptReturnOutput methodName:",e),te("[RestProvider] parseReceiptReturnOutput output:",r);var s=null===(n=t.schema)||void 0===n||null===(a=n[e])||void 0===a||null===(o=a.results)||void 0===o?void 0:o[0];if(te("[RestProvider] parseReceiptReturnOutput type:",s),!t||!s)throw Error("[RestProvider] parseReceiptReturnOutput not find abi schema for parse output: ".concat(r));return"function"!=typeof t.fromBuffer?null:t.fromBuffer(s,Buffer.from(r,"hex"))}}function Ba(e){return"0x".concat(Buffer.from(e,"base64").toString("hex"))}function Ia(t,r,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e){return e};te("[RestProvider] getTransactionRequest args:",t,r,n);var o=Ta(t,e(e({},r),{},{to:va(r.to),from:va(r.from),data:_a(t,r.data)[0]||""}),n);te("[RestProvider] getTransactionRequest txData:",o);var s=Pa(t,o);te("[RestProvider] getTransactionRequest rlpRawData:",s);var c=k(a(s));return te("[RestProvider] getTransactionRequest rlpData:",c),{txData:o,rlpData:c}}function Ra(e,t){if(e.filter((function(e){return!(!0===xe(e)&&!1===Ce(e)&&!1===we(e))})).length!==t.length)throw sr()}[{name:Jn,topics:"create_account",request_msg_type:2,response_msg_type:14,transaction_type:0,request:[br,[Tr,Fr]],response:[br,[Sr,hr]],data:un},{name:$n,topics:"transfer_balance",request_msg_type:3,response_msg_type:15,transaction_type:1,request:[br,[Tr,Fr]],response:[br,[Sr,hr]],data:[]},{name:Xn,topics:"set_recover_key",request_msg_type:4,response_msg_type:16,transaction_type:20,request:[br,[Tr,Fr]],response:[br,[Sr,hr]],data:[Xr]},{name:Zn,topics:"",request_msg_type:5,response_msg_type:17,transaction_type:21,request:[br,[Tr,Fr]],response:[br,[Sr,hr]],data:[]},{name:ea,topics:"",request_msg_type:6,response_msg_type:18,transaction_type:22,request:[br,[Tr,Fr]],response:[br,[Sr,hr]],data:[on,sn]},{name:ta,topics:"",request_msg_type:7,response_msg_type:19,transaction_type:23,request:[br,[Tr,Fr]],response:[br,[Sr,hr]],data:[on,sn]},{name:"FreezeAccount",topics:"",request_msg_type:24,response_msg_type:25,transaction_type:Vn,request:[br,[Tr,Fr]],response:[br,[Sr,hr]],data:[]},{name:"FreezeContract",topics:"",request_msg_type:28,response_msg_type:29,transaction_type:Vn,request:[br,[Tr,Fr]],response:[br,[Sr,hr]],data:[]},{name:"NativeDepositData",request_msg_type:36,response_msg_type:37,transaction_type:40,request:[br,[Tr,Fr]],response:[br,[Sr,hr]],data:[{name:"payload",type:"bytes"}]},{name:ra,request_msg_type:51,response_msg_type:58,transaction_type:"",request:[br,Tr],response:[br,[Sr,Gr]],data:[]},{name:na,request_msg_type:52,response_msg_type:59,transaction_type:"",request:[br,[Tr,Pr,hr]],response:[br,[Sr,Yr]],data:[]},{name:aa,request_msg_type:66,response_msg_type:67,transaction_type:"",request:[br,Tr],response:[br,[Sr,Yr]],data:[]},{name:oa,request_msg_type:53,response_msg_type:60,transaction_type:"",request:[br,[Tr,Pr,hr]],response:[br,[Sr,Gr]],data:[]},{name:sa,request_msg_type:55,response_msg_type:62,transaction_type:"",request:[br,[Tr,hr]],response:[br,[Sr,Fr,Pr,kr]],data:[]},{name:Gn,request_msg_type:56,response_msg_type:63,transaction_type:"",request:[br,[Tr,hr]],response:[br,[Sr,Ir,Pr,kr]],data:[]},{name:"QueryTransactionList",request_msg_type:94,response_msg_type:95,transaction_type:"",request:[br,[Tr,hr]],response:[br,[Sr,jr]],data:[]},{name:"QueryTransactionAndReceipt",request_msg_type:96,response_msg_type:97,transaction_type:"",request:[br,[Tr,hr]],response:[br,[Sr,Hr]],data:[]},{name:ca,request_msg_type:54,response_msg_type:61,transaction_type:"",request:[br,[Tr,hr]],response:[br,[Sr,un]],data:[]},{name:ia,request_msg_type:64,response_msg_type:65,transaction_type:"",request:[br,[Tr,hr]],response:[br,[Sr,fn]],data:[]},{name:"QueryTimestamp",request_msg_type:50,response_msg_type:57,transaction_type:"",request:[br,Tr],response:[br,[Sr,dr]],data:[]},{name:"QueryP2PStatus",request_msg_type:100,response_msg_type:101,transaction_type:"",request:[br,Tr,hn],response:[br,[Sr,gn]],data:[]},{name:"QueryConsensusStatus",request_msg_type:102,response_msg_type:103,transaction_type:"",request:[br,[Tr,hn]],response:[br,[Sr,Nn]],data:[]},{name:"QueryCommonConsensusStatus",request_msg_type:200,response_msg_type:201,transaction_type:"",request:[br,[Tr,hn]],response:[br,[Sr,{name:"type",type:"decimal"},{name:"info",type:"bytes"}]],data:[]},{name:"QuerySyncStatus",request_msg_type:104,response_msg_type:105,transaction_type:"",request:[br,[Tr,hn]],response:[br,[Sr,kn]],data:[]},{name:"QueryTransactionCacheStatus",request_msg_type:106,response_msg_type:107,transaction_type:"",request:[br,[Tr,hn]],response:[br,[Sr,qn]],data:[]},{name:"QueryBlockCacheStatus",request_msg_type:108,response_msg_type:109,transaction_type:"",request:[br,[Tr,hn]],response:[br,[Sr,En]],data:[]},{name:"QueryContractNodesStatus",request_msg_type:110,response_msg_type:111,transaction_type:"",request:[br,Tr],response:[br,[Sr,_n]],data:[]},{name:"QueryContractConfigStatus",request_msg_type:112,response_msg_type:113,transaction_type:"",request:[br,Tr],response:[br,[Sr,lr]],data:[]},{name:"QueryLogLevel",request_msg_type:152,response_msg_type:153,transaction_type:"",request:[br,Tr],response:[br,[Sr,{name:"level",type:"decimal"}]],data:[]},{name:"UpdateBlackList",request_msg_type:158,response_msg_type:159,transaction_type:"",request:[br,[Tr,Bn,Mr]],response:[br,Sr],data:[]},{name:"QueryBlockProof",request_msg_type:68,response_msg_type:69,transaction_type:"",request:[br,[Tr,Pr,hr]],response:[br,[Sr,In]],data:[]},{name:"QueryLatestStateProof",request_msg_type:70,response_msg_type:71,transaction_type:"",request:[br,[Tr,_r]],response:[br,[Sr,An]],data:[]},{name:"QueryStateProof",request_msg_type:80,response_msg_type:81,transaction_type:"",request:[br,[Tr,_r]],response:[br,[Sr,An]],data:[]},{name:"QueryTransactionProof",request_msg_type:72,response_msg_type:73,transaction_type:"",request:[br,[Tr,hr]],response:[br,[Sr,Un]],data:[]},{name:"QueryReceiptProof",request_msg_type:82,response_msg_type:83,transaction_type:"",request:[br,[Tr,hr]],response:[br,[Sr,zn]],data:[]},{name:"QueryBlockHeaderInfos",request_msg_type:74,response_msg_type:75,transaction_type:"",request:[br,[Tr,hr,Pr,{name:"max_amount",type:"decimal"},{name:"reverse",type:"decimal"}]],response:[br,[Sr,Mn]],data:[]},{name:"QueryBlockReceiptInfos",request_msg_type:76,response_msg_type:77,transaction_type:"",request:[br,[Tr,hr]],response:[br,[Sr,jn]],data:[]},{name:"QueryBlockBodyInfos",request_msg_type:78,response_msg_type:79,transaction_type:"",request:[br,[Tr,hr]],response:[br,[Sr,Qn]],data:[]},{name:ua,request_msg_type:8,response_msg_type:20,transaction_type:10,request:[br,[Tr,Fr]],response:[br,[Sr,hr]],data:[Tn]},{name:pa,request_msg_type:10,response_msg_type:22,transaction_type:12,request:[br,[Tr,Fr]],response:[br,[Sr,hr]],data:[Tn]},{name:fa,request_msg_type:9,response_msg_type:21,transaction_type:11,request:[br,[Tr,Fr]],response:[br,[Sr,hr]],data:[{name:"parameter",type:"bytes"}]},{name:"EventAccount",request_msg_type:120,response_msg_type:Yn,transaction_type:"",request:[br,[Tr,Sn,_r]],response:[br,[Sr,Pn]],data:[]},{name:ya,request_msg_type:121,response_msg_type:Yn,transaction_type:"",request:[br,[Tr,Sn,_r]],response:[br,[Sr,Pn]],data:[]},{name:"EventTopics",request_msg_type:122,response_msg_type:Yn,transaction_type:"",request:[br,[Tr,Sn,[wr]]],response:[br,[Sr,Pn]],data:[]},{name:"EventBlock",request_msg_type:123,response_msg_type:Yn,transaction_type:"",request:[br,[Tr,Sn,xr]],response:[br,[Sr,Pn]],data:[]},{name:la,request_msg_type:125,response_msg_type:136,transaction_type:"",request:[br,[Tr,Pn]],response:[br,[Sr,{name:"event_type",type:"decimal"},{name:"event_data",type:"bytes"}]],data:[]},{name:"EventCancel",request_msg_type:134,response_msg_type:135,transaction_type:"",request:[br,[Tr,[Pn]]],response:[br,[Er,xr,qr,Cr]],data:[]},{name:"LocalTransaction",request_msg_type:1,response_msg_type:13,request:[br,[Tr,Pr,Fr]],response:[br,[Sr,hr,Ir]],data:[]},{name:ha,request_msg_type:800,response_msg_type:801,transaction_type:500,request:[br,[Tr,Fr]],response:[br,[Sr,hr]],data:[{name:"encrypted_tx",type:"bytes"}]}].forEach((function(e){ma[e.name]=e,da[e.response_msg_type]=e}));var Ka=function(t){c(n,ue);var r=i(n);function n(t,o){return a(this,n),r.call(this,e({contractType:G.solidity},t),o)}return o(n,[{key:"generateDeployCode",value:function(e,t){if(t)throw Error("还未支持参数");return"0x01"+e.toString("utf-8")}},{key:"generateCallCode",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r="",n=JSON.parse(this.abi),a=0;n.length>a;a++){var o=n[a],s=[];Ce(o.inputs)&&(s=o.inputs);for(var c=[],i=[],u=0;s.length>u;u++){var p=s[u];c.push(p.type),i.push(p.name)}if("function"===o.type&&o.name===e&&t.length===c.length){var f=Et(o,c),h="0x"+ge(f).slice(0,8);Ra(t,c),r=h+ar.encodeParams(c,t);break}}if(!r)throw Error("未找到对应的方法，请检查方法名和参数是否正确。");return r}},{key:"parseReturnOutput",value:function(e,t){return function(e,t,r){if(!r)return"";var n=t.find((function(t){return t.name===e})),a=(Ce(n.outputs)?n.outputs:[]).map((function(e){return e.type})),o=ar.decodeParams(a,r);return 1===o.length?o[0]:o}(e,JSON.parse(this.abi),t)}}]),n}(),Aa=function(){};Aa.prototype.encodeParams=function(e,t,r,n){var a="";if(!1===be(e)||!1===xe(t)||!1===Ce(r))return a;if(!1===xe(t.schema)||!t.schema[e]||!r)return a;if(!1===xe(t.schema[e])||!1===xe(t.schema[e].fields))return a;var o=Object.keys(t.schema[e].fields);if(Ce(r)&&o.length!==r.length)return a;var s={},c=0;r&&Ce(r)&&o.forEach((function(e){s[e]=r[c],c++}));var i=t.toBuffer(e,s),u=t.toBuffer("string",e),p=t.toBuffer("bytes",i),f=g.concat([u,p]);if(n){var h=new g(4);h.writeUInt32BE(f.length),a=h.toString("hex")+f.toString("hex")}else a=f.toString("hex");return a},Aa.prototype.decodeParam=function(e,t,r){return e&&t&&r?!1==("function"==typeof e.fromBuffer)?null:e.fromBuffer(t,r):null};var Oa=new Aa,Da={name:"uint64",Identity:"bytes",checksum160:"fixed_bytes20",checksum256:"fixed_bytes32",checksum512:"fixed_bytes64",signature:"fixed_bytes65",public_key:"fixed_bytes33",message_type:"fixed_string16",symbol:"uint64",symbol_code:"uint64",field_name:"string",account_name:"name",permission_name:"name",type_name:"string",table_name:"name",scope_name:"name",action_name:"string",time_point:"int64",time_point_sec:"time",timestamp:"uint32",block_timestamp_type:"timestamp",block_id:"fixed_bytes32",checksum_type:"fixed_bytes32",checksum256_type:"fixed_bytes32",checksum512_type:"fixed_bytes64",checksum160_type:"fixed_bytes20",sha256:"fixed_bytes32",sha512:"fixed_bytes64",sha160:"fixed_bytes20",weight_type:"uint16",block_num_type:"uint32",share_type:"int64",digest_type:"checksum_type",context_free_type:"bytes",unsigned_int:"varuint32",bool:"uint8",extensions_type:{base:"",fields:{type:"uint16",data:"bytes"}},transaction_header:{base:"",fields:{expiration:"time",ref_block_num:"uint16",ref_block_prefix:"uint32",max_net_usage_words:"unsigned_int",max_cpu_usage_ms:"uint8",delay_sec:"unsigned_int"}},transaction:{base:"transaction_header",fields:{context_free_actions:"action[]",actions:"action[]",transaction_extensions:"extensions_type[]"}},signed_transaction:{base:"transaction",fields:{signatures:"signature[]",context_free_data:"bytes[]"}},fields:"field_def[]",field_def:{fields:{name:"field_name",type:"type_name"}},type_def:{base:"",fields:{new_type_name:"type_name",type:"type_name"}},struct_def:{base:"",fields:{name:"type_name",base:"type_name",fields:"field_def[]"}},clause_pair:{base:"",fields:{id:"string",body:"string"}},error_message:{base:"",fields:{error_code:"uint64",error_msg:"string"}},abi_def:{base:"",fields:{version:"string",types:"type_def[]",structs:"struct_def[]",actions:"action_def[]",tables:"table_def[]",ricardian_clauses:"clause_pair[]",error_messages:"error_message[]",abi_extensions:"extensions_type[]"}},table_def:{base:"",fields:{name:"table_name",index_type:"type_name",key_names:"field_name[]",key_types:"type_name[]",type:"type_name"}},permission_level:{base:"",fields:{actor:"account_name",permission:"permission_name"}},action:{base:"",fields:{name:"action_name"}},action_def:{base:"",fields:{name:"string",type:"type_name"}}},La=function(e){return{"abi_def.fromObject":function(e){if("string"==typeof e){var t=""+g.from(e,"hex");return 0===t.length&&(t=""+g.from(e)),JSON.parse(t)}return g.isBuffer(e)?JSON.parse(""+e):null}}},Wa=function(e){return{"setcode.code.fromObject":function(t){var r=t.object,n=t.result;try{var a=""+r.code;if(/^\s*\(module/.test(a)){var o=e.binaryen;e.debug&&console.log("Assembling WASM..");var s=g.from(o.parseText(a).emitBinary());n.code=s}else n.code=r.code}catch(e){throw console.error(e,r.code),e}}}};function Ua(e){null==e&&(e={}),e.abiCache={abi:function(e,n){if(n){g.isBuffer(n)&&(n=JSON.parse(n));var a=function(e,t){var r={};e.types&&e.types.forEach((function(e){r[e.new_type_name]=e.type}));e.structs&&e.structs.forEach((function(e){var t,n={},a=I(e.fields);try{for(a.s();!(t=a.n()).done;){var o=t.value;n[o.name]=o.type}}catch(e){a.e(e)}finally{a.f()}r[e.name]={base:e.base,fields:n,results:e.results},""===e.base&&delete r[e.name].base}));e.interfaces&&e.interfaces.forEach((function(e){var n=r[e.type];n?n.interface={name:e.name}:console.error("Missing abiSchema type",e.type,t)}));return r}(n,e),o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=Object.assign({},La(),Wa(e),e.override),n=Object.assign({},{},e.customTypes);(e=Object.assign({override:r},{customTypes:n},e)).sort=Object.assign({},e.sort);var a=Object.assign({},Da,t),o=R(a,e),s=o.structs,c=o.types,i=o.errors,u=o.fromBuffer,p=o.toBuffer;if(0!==i.length)throw Error(JSON.stringify(i,null,4));return{structs:s,types:c,fromBuffer:u,toBuffer:p}}(t,a);return r[e]=Object.assign({abi:n,schema:a},o)}var s=r[e];if(null==s)throw Error("Abi '".concat(e,"' is not cached"));return s}};var t=Object.assign({},{defaults:!0},e),r={};return e.abiCache}function za(e,t){var r=K.md.sha256.create().update(t,"utf8");te("[signMessage] message hash:",r.digest().toHex());var n=""+K.pki.privateKeyFromPem(e).sign(r),a=Buffer.from(K.util.binary.raw.decode(n)).toString("hex");return te("[signMessage] result:",a),a}function Ma(e,t){if(te("[parsePrivateKeyToAES] privateKey:",e),te("[parsePrivateKeyToAES] passphrase:",t),Q){var r=require("crypto").createPrivateKey({format:"pem",key:e,passphrase:t}).export({type:"sec1",format:"pem",cipher:"aes-256-cbc",passphrase:t});return te("[parsePrivateKeyToAES] use node crypto, result:",r),r}return te("[parsePrivateKeyToAES] 浏览器端需要用户手动进行转换"),e}function Fa(e,t){return Ua().abi(e,Buffer.from(t))}function ja(e,t){return Ha.apply(this,arguments)}function Ha(){return(Ha=r(t.mark((function e(r,n){var a;return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(te("[utils/mychain] getUserInfo"),a=_t(Ma(r,n),n)){e.next=4;break}throw Error("[utils/mychain] 获取用户信息失败，请检查 account 相关配置");case 4:return e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Qa(e){return Ke(e)}function Va(e){var t=e.startsWith("0x")?e.substring(2):e;return Buffer.from(t,"hex").toString("base64")}function Ya(e){return e.startsWith("0x")?e.substring(2):e}var Ja=function(t){c(n,ue);var r=i(n);function n(t,o){var s;return a(this,n),(s=r.call(this,e({contractType:G.assemblyscript},t),o)).abier=void 0,s.abier=Fa(t.contractName,s.abi),s}return o(n,[{key:"generateDeployCode",value:function(e,t){if(t)throw Error("还未支持参数");var r=e.toString("hex"),n=function(e){var t=new g(4);return t.writeUInt32BE(e),t.toString("hex")}(r.length/2);return"0x02"+n+r}},{key:"generateCallCode",value:function(e,t){var r="",n=this.abier.schema[e].fields||{},a=[];for(var o in n)a.push({key:o,type:n[o]});return(r=Oa.encodeParams(e,this.abier,t||[]))&&(r="0x"+r),r}},{key:"parseReturnOutput",value:function(e,t){var r;if(t){var n=t;0===n.indexOf("0x")&&(n=n.slice(2));var a=null===(r=this.abier.schema[e])||void 0===r?void 0:r.results,o=Oa.decodeParam(this.abier,a&&a.length>0&&a[0],Buffer.from(n,"hex"));return 1===o.length?o[0]:o}}}]),n}();function Ga(e){return new Promise((function(t){setTimeout((function(){t()}),e)}))}var $a=3e4,Xa=[3e4,1e4,5e3,2e3,1e3],Za=function(e){c(u,A);var n,s=i(u);function u(){return a(this,u),s.apply(this,arguments)}return o(u,[{key:"queryTransactionReceiptWithRetry",value:(n=r(t.mark((function e(r,n){var a,o=arguments;return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=o.length>2&&void 0!==o[2]?o[2]:Xa.length-1)>=0){e.next=6;break}return e.next=4,Ga(3e4);case 4:e.next=8;break;case 6:return e.next=8,Ga(Xa[a]);case 8:return e.prev=8,e.next=11,this.queryTransactionReceipt(r);case 11:case 28:return e.abrupt("return",e.sent);case 14:if(e.prev=14,e.t0=e.catch(8),"404"===e.t0.code||"414"===e.t0.code){e.next=19;break}throw te("code is ".concat(e.t0.code,", stop retry")),e.t0;case 19:if(!n){e.next=24;break}if(Date.now()<=n){e.next=22;break}throw Error("queryTransactionReceipt timeout");case 22:e.next=26;break;case 24:if(0!==a){e.next=26;break}throw Error("queryTransactionReceipt retry times out");case 26:return e.next=28,this.queryTransactionReceiptWithRetry(r,n,a-1);case 29:case"end":return e.stop()}}),e,this,[[8,14]])}))),function(e,t){return n.apply(this,arguments)})}]),u}(),eo={ecdhCurve:"secp256k1:prime256v1"},to=function(){function t(e,r){var n=e.host,o=e.port,s=e.clients,c=e.timeout,i=e.cert,u=e.ca,p=e.key,f=e.passphrase,h=e.checkServerIdentity,y=e.sendCallback;a(this,t),this.callback=void 0,this.sendCallback=void 0,this.retryNum=void 0,this.clients=void 0,this.currentClient=void 0,this.host=void 0,this.port=void 0,this.timeout=void 0,this.cert=void 0,this.ca=void 0,this.key=void 0,this.passphrase=void 0,this.checkServerIdentity=void 0,this.socket=void 0,this.callback=r,this.sendCallback=y||"",this.retryNum=0;var l=n,d=o,m=s;l&&d?(Array.isArray(s)||(m=[]),m=[{host:l,port:d}].concat(m)):Array.isArray(s)&&s.length&&(l=s[0].host,d=s[0].port),this.clients=m||[],this.currentClient=0,this.resetConnect({host:n,port:o,timeout:c,cert:i,ca:u,key:p,passphrase:f,checkServerIdentity:h})}return o(t,[{key:"doCallback",value:function(e,t){"function"==typeof this.callback&&this.callback(e,t)}},{key:"setConfig",value:function(e){var t=e.port,r=e.timeout,n=e.cert,a=e.ca,o=e.key,s=e.passphrase,c=e.checkServerIdentity;this.host=e.host||"localhost",this.port=t||"18130",this.timeout=r||3e4,this.cert=n||"",this.ca=a||"",this.key=o||"",this.passphrase=s||"",this.checkServerIdentity=c}},{key:"connect",value:function(){var e=this,t=O.createSecureContext({cert:this.cert,ca:[this.ca],key:this.key,passphrase:this.passphrase,ciphers:"ALL",ecdhCurve:eo.ecdhCurve}),r={host:this.host,port:this.port,secureContext:t,checkServerIdentity:void 0};this.checkServerIdentity||(r.checkServerIdentity=function(){});var n=O.connect(r,(function(){n.authorized?(e.retryNum=0,e.doCallback()):e.doCallback(cr)}));return n}},{key:"resetConnect",value:function(t){var r=this;this.setConfig(t),this.socket=this.connect();var n=null;this.socket.on("readable",(function(e){if(n||(n=r.socket.read(16)),n){var t=Le(n),a=r.socket.read(t-16);if(a){var o=function(e,t){return{total_len:Le(e),version:e.readInt16BE(4),magic1:e.readInt8(6),magic2:e.readInt8(7),reserved1:e.readInt32BE(8),reserved2:e.readInt32BE(12),data:ze(t)}}(n,a);n=null,"function"==typeof r.sendCallback&&r.sendCallback(e,o.data)}}})),this.socket.on("close",(function(){if(4>r.retryNum)r.retryNum++,setTimeout((function(){r.resetConnect(t)}),1e3);else{r.currentClient++;var n=r.clients[r.currentClient];n&&setTimeout((function(){r.retryNum=0,r.resetConnect(e(e({},t),{},{host:n.host,port:n.port}))}),1e3)}})),this.socket.on("error",(function(e){console.error(e)}))}},{key:"send",value:function(e){var t=function(e){var t=Array.isArray(e)?We(e):e,r=16+t.length,n=g.alloc(16);return n.writeInt32BE(r,0),n.writeInt16BE(2,4),n.writeInt8(51,6),n.writeInt8(119,7),n.writeInt32BE(0,8),n.writeInt32BE(0,12),g.concat([n,t],r)}(e);this.socket.write(t,"buffer",(function(){}))}}]),t}(),ro=function(e,t){return new to(e,t)};ro.setEcdhCurve=function(e){eo.ecdhCurve=e},ro.setPrime256v1EcdhCurve=function(){this.setEcdhCurve("prime256v1")};var no=function(){function n(o,s){var c=this;a(this,n),this.sender=null,this.callbacks={},this.sendCache=[],this.sessionId="",this.callback=null,this.currentSequence=1,this.userPublicKey=void 0,this.userSignature=void 0,this.userPrivateKey=void 0,this.userRecoverPrivateKey=void 0,this.userRecoverPublicKey=void 0,this.options=void 0,this.userKeySeted=!1,this.setUserKey=r(t.mark((function e(){var r,n,a,o,s,i,u;return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c.userKeySeted){e.next=2;break}return e.abrupt("return");case 2:return n=(r=c.options).accountPrivateKey,a=r.accountPrivateKeyPassword,o=r.accountRecoverPrivateKey,s=r.accountRecoverPrivateKeyPassword,e.next=5,ja(n,a);case 5:if(i=e.sent,!o){e.next=12;break}return e.next=9,ja(o,s);case 9:c.userRecoverPrivateKey=qe((u=e.sent).privateKey),c.userRecoverPublicKey=qe(u.publicKey);case 12:c.userPublicKey=qe(i.publicKey||"0x97466f2b32bc3bb76d4741ae51cd1d8578b48d3f1e68da206d47321aec267ce78549b514e4453d74ef11b0cd5e4e4c364effddac8b51bcfc8de80682f952896f"),c.userPrivateKey=qe(i.privateKey||"0x3ecb44df2159c26e0f995712d4f39b6f6e499b40749b1cf1246c37f9516cb6a4"),c.userKeySeted=!0;case 15:case"end":return e.stop()}}),e)}))),this.sendCallback=function(e,t){var r=function(e){var t=parseInt(e[0],16);e[0]&&ke(e[0])&&(t=parseInt(e[0].toString("hex"),16));var r=da[t];if(!r){if(e[0]&&e[0][0]){var n=Ca(e,fr);return n.api="Handshake",n}throw Error('msg_type "'+t+'" is not error')}var a=r.name,o=Ca(e,r.response);return o.api=a,o}(t);if(te("[TSL connector] sendCallback get data",r),"Handshake"===r.api){if(c.sessionId=r.session_id||"","function"==typeof c.callback&&(c.callback(e,r),c.callback=null),c.sendCache.length)for(var n=c.sendCache.shift();n;)c._send(n.rlpData),n=c.sendCache.shift()}else{var a=c.callbacks[r.sequence];"function"==typeof a&&a(0!==r.return_code?new oe("[TLSConnector] request failed, code: ".concat(r.return_code),r.return_code+"",r):e,r)}},this.getSequence=function(){return c.currentSequence++},this.getBaseData=r(t.mark((function e(){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.setUserKey();case 2:return e.abrupt("return",{isSign:void 0===c.options.isSign||c.options.isSign,from:c.options.account,userPrivateKey:c.userPrivateKey,userPublicKey:c.userPublicKey,userRecoverPrivateKey:c.userRecoverPrivateKey,userRecoverPublicKey:c.userRecoverPublicKey});case 3:case"end":return e.stop()}}),e)}))),this._send=function(e){te("[TSL connector] send data",e),c.sender.send(e)},this.handshake=r(t.mark((function e(){var r,n;return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return te("[TSL connector] handshake..."),n=void 0===(r=c.options.nonce)?"hello world":r,e.next=4,c.setUserKey();case 4:c.userSignature=kt(n,c.userPrivateKey),c.sender.send([n,c.userPrivateKey,c.userSignature,0]);case 6:case"end":return e.stop()}}),e)}))),this.callback=s,this.options=o,this.sender=ro(e(e({},o),{},{sendCallback:this.sendCallback}),(function(e){e&&(console.error(e),s&&s(e)),c.handshake()}))}var s;return o(n,[{key:"send",value:(s=r(t.mark((function e(r,n){var a=this;return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){a.callbacks[n]=function(r,n){r?t(r):e(n)},a.sessionId?a._send(r):a.sendCache.push({sequence:n+"",rlpData:r})})));case 1:case"end":return e.stop()}}),e)}))),function(e,t){return s.apply(this,arguments)})}]),n}();function ao(e,t){var r=t.getSequence(),n=wa(ra,{sequence:r});return t.send(n,r)}function oo(e,t){var r=t.getSequence(),n=wa(na,{sequence:r,block_number:e.blockNumber||0,hash:e.hash||"0x0"});return t.send(n,r)}function so(e,t){var r=t.getSequence(),n=wa(aa,{sequence:r});return t.send(n,r)}function co(e,t){var r=t.getSequence(),n=wa(oa,{sequence:r,block_number:e.blockNumber||0,hash:e.hash||"0x0"});return t.send(n,r)}function io(e,t){var r=t.getSequence(),n={sequence:r,group_id:e.groupId||"0x0000000000000000000000000000000000000000",hash:va(e.account)},a=wa(ca,n);return t.send(a,r)}function uo(e,t){var r=t.getSequence(),n={sequence:r,group_id:e.groupId||"0x0000000000000000000000000000000000000000",hash:va(e.hash)},a=wa(sa,n);return t.send(a,r)}function po(e,t){return fo.apply(this,arguments)}function fo(){return fo=r(t.mark((function e(r,n){var a,o,s;return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.getSequence(),o={sequence:a,group_id:r.groupId||"0x0000000000000000000000000000000000000000",hash:va(r.hash)},s=wa(Gn,o),e.next=5,n.send(s,a);case 5:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)}))),fo.apply(this,arguments)}function ho(e,t){var r=t.getSequence(),n={sequence:r,hash:va(e.contractName)},a=wa(ia,n);return t.send(a,r)}function yo(e,t){return lo.apply(this,arguments)}function lo(){return lo=r(t.mark((function e(r,n){var a,o,s,c,i,u,p,f;return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.getSequence(),o=va(r.from),s=va(r.to),e.next=5,n.getBaseData();case 5:return(c=e.sent).sequence=a,i=[],r.authMap.forEach((function(e){i.push(e.authKey),i.push(e.authWeight)})),u={identity:s,recover_key:r.recoveryKey,auth_map:Ue(i)},p=Ta(Jn,{from:o,to:s,data:Ue(_a(Jn,u))},c),f=wa(Jn,p),e.next=14,n.send(f,a);case 14:return e.abrupt("return",e.sent);case 16:case"end":return e.stop()}}),e)}))),lo.apply(this,arguments)}function mo(e,t){return vo.apply(this,arguments)}function vo(){return vo=r(t.mark((function e(r,n){var a,o,s,c,i;return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.getSequence(),o=va(r.account),e.next=4,n.getBaseData();case 4:return(s=e.sent).sequence=a,c=Ta(ta,{from:o,to:o,data:Ue(_a(ta,{auth_key:r.authMap[0].key,auth_weight:100}))},s),i=wa(ta,c),e.next=12,n.send(i,a);case 12:return e.abrupt("return",e.sent);case 14:case"end":return e.stop()}}),e)}))),vo.apply(this,arguments)}function go(e,t){return _o.apply(this,arguments)}function _o(){return _o=r(t.mark((function e(r,n){var a,o,s,c,i,u,p;return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.getSequence(),o=r.contract,e.next=4,n.getBaseData();case 4:if((s=e.sent).sequence=a,c=o.generateDeployCode(r.code),i=Ta(ua,{from:va(r.from),to:va(o.contractName),data:_a(ua,{code:c})[0]||""},s),u=wa(ua,i),!r.encrypt){e.next=17;break}return p=Sa({from:va(r.from),to:va(o.contractName),data:_a(ha,{encrypted_tx:xt(r.publicKey,u,r.aesKey,i.hash,r.encryptType)})[0]||""},s,i.timestamp,i.hash),e.next=13,n.send(wa(ha,p),a);case 13:return e.abrupt("return",e.sent);case 17:return e.next=19,n.send(u,a);case 19:return e.abrupt("return",e.sent);case 21:case"end":return e.stop()}}),e)}))),_o.apply(this,arguments)}function ko(e,t){return wo.apply(this,arguments)}function wo(){return wo=r(t.mark((function e(r,n){var a,o,s,c,i;return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.getSequence(),e.next=3,n.getBaseData();case 3:return(o=e.sent).sequence=a,0===(s=r.code).indexOf("0x")&&(s=s.slice(2)),s="0x"+(r.vm===$.EVM?"01":"02")+s,c=Ta(pa,{from:va(r.contractName),to:va(r.contractName),data:_a(pa,{code:s})[0]||""},o),i=wa(pa,c),e.next=13,n.send(i,a);case 13:return e.abrupt("return",e.sent);case 15:case"end":return e.stop()}}),e)}))),wo.apply(this,arguments)}function bo(e,t){return xo.apply(this,arguments)}function xo(){return xo=r(t.mark((function e(r,n){var a,o,s,c,i,u,p;return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.getSequence(),o=r.contract,e.next=4,n.getBaseData();case 4:if((s=e.sent).sequence=a,c=o.generateCallCode(r.methodName,r.args),i=Ta(fa,{from:va(r.from),to:va(o.contractName),data:_a(fa,{parameter:c})[0]||""},s),u=wa(fa,i),!r.encrypt){e.next=18;break}return p=Sa({to:va(o.contractName),data:_a(ha,{encrypted_tx:xt(r.publicKey,u,r.aesKey,i.hash,r.encryptType)})[0]||""},s,i.timestamp,i.hash),e.next=14,n.send(wa(ha,p),a);case 14:return e.abrupt("return",e.sent);case 18:return e.next=20,n.send(u,a);case 20:return e.abrupt("return",e.sent);case 22:case"end":return e.stop()}}),e)}))),xo.apply(this,arguments)}function Co(e,t){return qo.apply(this,arguments)}function qo(){return qo=r(t.mark((function e(r,n){var a,o,s,c;return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.getSequence(),e.next=3,n.getBaseData();case 3:return(o=e.sent).sequence=a,s=Ta($n,{from:va(r.from),to:va(r.to),data:"0x0",value:r.value},o),c=wa($n,s),e.next=9,n.send(c,a);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e)}))),qo.apply(this,arguments)}function Eo(e,t){return To.apply(this,arguments)}function To(){return To=r(t.mark((function e(r,n){var a,o,s,c,i;return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=va(r.account),o=n.getSequence(),e.next=4,n.getBaseData();case 4:return(s=e.sent).sequence=o,c=Ta(Xn,{from:a,to:a,data:_a(Xn,{recover_key:r.recoverKey})[0]||""},s),i=wa(Xn,c),e.next=10,n.send(i,o);case 10:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}}),e)}))),To.apply(this,arguments)}function So(e,t){return Po.apply(this,arguments)}function Po(){return Po=r(t.mark((function e(r,n){var a,o,s,c,i;return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=va(r.account),o=n.getSequence(),e.next=4,n.getBaseData();case 4:if((s=e.sent).userRecoverPrivateKey){e.next=7;break}throw Error("userRecoverPrivateKey is not set");case 7:return s.sequence=o,c=Ta(Zn,{from:a,to:a},s,s.userRecoverPrivateKey),i=wa(Zn,c),e.next=12,n.send(i,o);case 12:return e.abrupt("return",e.sent);case 14:case"end":return e.stop()}}),e)}))),Po.apply(this,arguments)}function No(e,t){return Bo.apply(this,arguments)}function Bo(){return Bo=r(t.mark((function e(r,n){var a,o,s,c,i;return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=va(r.account),o=n.getSequence(),e.next=4,n.getBaseData();case 4:if((s=e.sent).userRecoverPrivateKey){e.next=7;break}throw Error("userRecoverPrivateKey is not set");case 7:return s.sequence=o,c=Ta(ea,{from:a,to:a,data:Ue(_a(ea,{auth_key:r.authKey,auth_weight:100}))},s,s.userRecoverPrivateKey),i=wa(ea,c),e.next=13,n.send(i,o);case 13:return e.abrupt("return",e.sent);case 15:case"end":return e.stop()}}),e)}))),Bo.apply(this,arguments)}function Io(e,t){return Ro.apply(this,arguments)}function Ro(){return Ro=r(t.mark((function r(n,a){var o,s,c,i,u;return t.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=a.getSequence(),s=wa(la,{sequence:o,filter_id:n.filterId}),t.next=5,a.send(s,o);case 5:if(!(c=t.sent).event_data){t.next=10;break}return i=De(c.event_data),u=ze(i),t.abrupt("return",e(e({},c),{},{event_data:qa(c.event_type,u)}));case 10:return t.abrupt("return",c);case 11:case"end":return t.stop()}}),r)}))),Ro.apply(this,arguments)}var Ko,Ao=function(n){c(X,Za);var s,u,p,f,h,y,l,d,m,v,g,_,k,w,b,x,C,q,E,T,S,P,N,B,I,R,K,A,O,D,L,W,U,z,M,F,j,H,Q,V,Y,J,G=i(X);function X(){var e,t,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a(this,X),(r=G.call(this)).majorVersion=1,r.config=void 0,r.teeExtraParams=void 0,r.connector=void 0,r.eventsId=[],r.EVENTLOOPTIME=6e3,r.eventTimeout=void 0,r.config=n,r.teeExtraParams={aesKey:null===(e=r.config)||void 0===e?void 0:e.teePassword,encrypt:!0,encryptType:"02",publicKey:null===(t=r.config)||void 0===t?void 0:t.teePublicKey},r.connector=new no({host:r.config.host,port:r.config.port,cert:r.config.cert,ca:r.config.ca,passphrase:r.config.privateKeyPassword,key:r.config.privateKey,account:r.config.account,accountPrivateKey:r.config.accountPrivateKey,accountPrivateKeyPassword:r.config.accountPrivateKeyPassword,accountRecoverPrivateKey:r.config.accountRecoverPrivateKey,accountRecoverPrivateKeyPassword:r.config.accountRecoverPrivateKeyPassword}),r}return o(X,[{key:"startEventLoop",value:function(){this.eventTimeout||0===this.eventsId.length||this.fetchEvents()}},{key:"fetchEvents",value:function(){var e=this;this.eventsId.forEach(function(){var n=r(t.mark((function r(n){var a;return t.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Io({filterId:n},e.connector);case 2:te("get res with event id and res",n,a=t.sent),e.emit(n,a);case 5:case"end":return t.stop()}}),r)})));return function(e){return n.apply(this,arguments)}}()),this.eventTimeout=setTimeout((function(){e.fetchEvents()}),this.EVENTLOOPTIME)}},{key:"watchContractEvent",value:function(e,t,r){var n=this;(function(e,t){var r=t.getSequence(),n={sequence:r,event_type:e.type,identity:va(e.contractName)},a=wa(ya,n);return t.send(a,r)})({contractName:e.contractName,type:ae.CONTRACT},this.connector).then((function(e){var t=e.filter_id;n.on(t,r),n.eventsId.push(t),n.startEventLoop()}))}},{key:"createAccount",value:(J=r(t.mark((function e(r){var n;return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,yo({from:this.config.account,to:r.newAccountName,recoveryKey:r.recoveryKey,authMap:[{authKey:r.authKey,authWeight:100}]},this.connector);case 2:return n=e.sent,e.next=5,this.queryTransactionReceiptWithRetry({hash:n.hash});case 5:return e.abrupt("return",{txHash:n.hash});case 6:case"end":return e.stop()}}),e,this)}))),function(e){return J.apply(this,arguments)})},{key:"transferBalance",value:(Y=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Co({from:r.from||this.config.account,to:r.to,value:r.value},this.connector);case 2:return e.abrupt("return",{txHash:e.sent.hash});case 4:case"end":return e.stop()}}),e,this)}))),function(e){return Y.apply(this,arguments)})},{key:"setRecoverkey",value:(V=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Eo({account:r.account||this.config.account,recoverKey:r.recoverKey},this.connector);case 2:return e.abrupt("return",{txHash:e.sent.hash});case 4:case"end":return e.stop()}}),e,this)}))),function(e){return V.apply(this,arguments)})},{key:"preResetPubKey",value:(Q=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,So({account:r.account||this.config.account},this.connector);case 2:return e.abrupt("return",{txHash:e.sent.hash});case 4:case"end":return e.stop()}}),e,this)}))),function(e){return Q.apply(this,arguments)})},{key:"resetPubKey",value:(H=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,No({account:r.account||this.config.account,authKey:r.authKey},this.connector);case 2:return e.abrupt("return",{txHash:e.sent.hash});case 4:case"end":return e.stop()}}),e,this)}))),function(e){return H.apply(this,arguments)})},{key:"freezeAccount",value:(j=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return j.apply(this,arguments)})},{key:"freezeContract",value:(F=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return F.apply(this,arguments)})},{key:"nativeDepositData",value:(M=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return M.apply(this,arguments)})},{key:"queryLastBlockHeader",value:(z=r(t.mark((function e(){var r;return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,so(0,this.connector);case 2:return e.abrupt("return",{gasUsed:(r=e.sent.block_header).gas_used,hash:r.hash,logBloom:r.log_bloom,number:r.block_number,parentHash:r.parent_hash,receiptRoot:r.receipt_root,stateRoot:r.state_root,timestamp:r.timestamp,transactionRoot:r.transaction_root,version:r.version});case 5:case"end":return e.stop()}}),e,this)}))),function(){return z.apply(this,arguments)})},{key:"queryTransactionList",value:(U=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return U.apply(this,arguments)})},{key:"queryTransactionAndReceipt",value:(W=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return W.apply(this,arguments)})},{key:"queryTimestamp",value:(L=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return L.apply(this,arguments)})},{key:"queryP2PStatus",value:(D=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return D.apply(this,arguments)})},{key:"queryConsensusStatus",value:(O=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return O.apply(this,arguments)})},{key:"queryCommonConsensusStatus",value:(A=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return A.apply(this,arguments)})},{key:"querySyncStatus",value:(K=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return K.apply(this,arguments)})},{key:"queryTransactionCacheStatus",value:(R=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return R.apply(this,arguments)})},{key:"queryBlockCacheStatus",value:(I=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return I.apply(this,arguments)})},{key:"queryContractNodesStatus",value:(B=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return B.apply(this,arguments)})},{key:"queryContractConfigStatus",value:(N=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return N.apply(this,arguments)})},{key:"queryLogLevel",value:(P=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return P.apply(this,arguments)})},{key:"updateBlackList",value:(S=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return S.apply(this,arguments)})},{key:"queryBlockProof",value:(T=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return T.apply(this,arguments)})},{key:"queryBlockHeaderProof",value:(E=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return E.apply(this,arguments)})},{key:"queryStateProof",value:(q=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return q.apply(this,arguments)})},{key:"queryTransactionProof",value:(C=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return C.apply(this,arguments)})},{key:"queryReceiptProof",value:(x=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return x.apply(this,arguments)})},{key:"queryBlockHeaderInfos",value:(b=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return b.apply(this,arguments)})},{key:"queryBlockReceiptInfos",value:(w=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return w.apply(this,arguments)})},{key:"queryBlockBodyInfos",value:(k=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return k.apply(this,arguments)})},{key:"queryAccount",value:(_=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",io({account:r.account},this.connector).then((function(e){var t,r=e.data;return{address:r.identity,balance:r.balance,encryptionKey:r.encryption_key,recoveryKey:r.recover_key,recoveryTime:r.recover_time,authMap:null===(t=r.auth_map)||void 0===t?void 0:t.map((function(e){return{key:e.auth_key,weight:e.auth_weight}})),status:r.status,version:r.acc_version}})));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return _.apply(this,arguments)})},{key:"updateAuthMap",value:(g=r(t.mark((function e(r){var n;return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,mo(r,this.connector);case 2:return n=e.sent.hash,e.next=6,this.queryTransactionReceiptWithRetry({hash:n});case 6:return e.abrupt("return",{txHash:n});case 7:case"end":return e.stop()}}),e,this)}))),function(e){return g.apply(this,arguments)})},{key:"queryBlockHeader",value:(v=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",oo({blockNumber:r.blockNumber,hash:r.hash},this.connector).then((function(e){var t=e.block_header;return{gasUsed:t.gas_used,hash:t.hash,logBloom:t.log_bloom,number:t.block_number,parentHash:t.parent_hash,receiptRoot:t.receipt_root,stateRoot:t.state_root,timestamp:t.timestamp,transactionRoot:t.transaction_root,version:t.version}})));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"queryBlock",value:(m=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",co({blockNumber:r.blockNumber,hash:r.hash},this.connector).then((function(e){var t=e.block,r=t.block_header,n=t.block_body;return{gasUsed:r.gas_used,hash:r.hash,logBloom:r.log_bloom,number:r.block_number,parentHash:r.parent_hash,receiptRoot:r.receipt_root,stateRoot:r.state_root,timestamp:r.timestamp,transactionRoot:r.transaction_root,version:r.version,transactionList:n.transaction_list,receiptList:n.receipt_list,consensusProof:n.consensus_proof}})));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"queryLastBlock",value:(d=r(t.mark((function e(){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ao(0,this.connector).then((function(e){var t=e.block.block_header;return{gasUsed:t.gas_used,hash:t.hash,logBloom:t.log_bloom,number:t.block_number,parentHash:t.parent_hash,receiptRoot:t.receipt_root,stateRoot:t.state_root,timestamp:t.timestamp,transactionRoot:t.transaction_root,version:t.version}})));case 1:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"queryTransaction",value:(l=r(t.mark((function e(r){var n,a=this;return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.tee,e.abrupt("return",uo({hash:r.hash},this.connector).then((function(e){var t=n?Ea(e.transaction.data,a.config.teePassword,e.transaction.hash):e.transaction.data;return{blockNumber:e.block_number,hash:e.transaction.hash,data:t,to:e.transaction.to,from:e.transaction.from}})));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"queryTransactionReceipt",value:(y=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",po({hash:r.hash},this.connector).then((function(e){return{blockNumber:e.block_number,gasUsed:e.receipt.gas_used,output:e.receipt.output,code:e.receipt.result,logs:e.receipt.log_entry.map((function(e){return{from:e.from,to:e.to,logData:e.log_data,topics:e.topics}}))}})));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return y.apply(this,arguments)})},{key:"deployContract",value:(h=r(t.mark((function r(n,a){var o,s;return t.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o={},a.tee&&Object.assign(o,this.teeExtraParams),t.next=4,go(e({contract:n,code:a.code,from:this.config.account},o),this.connector);case 4:return s=t.sent.hash,t.next=8,this.queryTransactionReceiptWithRetry({hash:s});case 8:return t.abrupt("return",{txHash:s,teeSecret:a.tee?wt(this.config.teePassword,s).toString("hex"):void 0});case 9:case"end":return t.stop()}}),r,this)}))),function(e,t){return h.apply(this,arguments)})},{key:"updateContract",value:(f=r(t.mark((function e(r,n){var a;return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ko({contractName:r.contractName,code:r.vmType===$.WASM?"0x".concat(n.code.toString("hex")):n.code.toString("utf-8"),vm:r.vmType},this.connector);case 2:return a=e.sent.hash,e.next=6,this.queryTransactionReceiptWithRetry({hash:a});case 6:return e.abrupt("return",{txHash:a});case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return f.apply(this,arguments)})},{key:"callContract",value:(p=r(t.mark((function r(n,a){var o,s,c,i,u;return t.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o={},a.tee&&Object.assign(o,this.teeExtraParams),t.next=4,bo(e({contract:n,from:this.config.account,args:a.args,methodName:a.methodName},o),this.connector);case 4:return s=t.sent.hash,t.next=8,this.queryTransactionReceiptWithRetry({hash:s},a.timeout?Date.now()+a.timeout:void 0);case 8:return c=t.sent,i=a.tee?qt(c.output,this.config.teePassword,s):c.output,u=n.parseReturnOutput(a.methodName,Ya(i)),t.abrupt("return",{txHash:s,receiptCode:c.code,returnValue:u,teeSecret:a.tee?wt(this.config.teePassword,s).toString("hex"):void 0});case 12:case"end":return t.stop()}}),r,this)}))),function(e,t){return p.apply(this,arguments)})},{key:"queryContract",value:(u=r(t.mark((function e(r){var n;return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ho(r,this.connector);case 2:return e.abrupt("return",{code:(n=e.sent).data.code,authMap:n.data.auth_map.map((function(e){return{key:e.auth_key,weight:e.auth_weight}}))});case 4:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"sign",value:(s=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("暂不支持");case 1:case"end":return e.stop()}}),e)}))),function(e){return s.apply(this,arguments)})}]),X}(),Oo=function(){var n=r(t.mark((function r(n,a){var o,s,c,i,u,p,f;return t.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=void 0===(o=a.method)?"GET":o,i=void 0===(c=a.body)?{}:c,p=void 0===(u=a.headers)?{}:u,"undefined"==typeof fetch){t.next=8;break}return t.next=4,fetch(n,{method:s,body:JSON.stringify(i),headers:e({"Content-Type":"application/json"},p)});case 4:if((f=t.sent).ok){t.next=7;break}throw Error("[utils/fetch] res.ok is false");case 7:return t.abrupt("return",f.json());case 8:return t.next=10,L(n,{method:s,data:i,headers:p});case 10:return t.abrupt("return",t.sent.data);case 12:case"end":return t.stop()}}),r)})));return function(e,t){return n.apply(this,arguments)}}(),Do={100:"哈希计算错误",101:"交易指针为空指针",102:"交易的 data 字段不满足类型约束",103:"签名不可用",104:"交易的发送账户余额不足",105:"交易的时间戳所在时间段无效，合约平台会对时间戳做检查，不在特定的时间范围内将被认为不可用",106:"交易的目标账户不包含可用的合约哈希",107:"交易的目标账户为空",108:"创建账户的交易不满足需求",109:"部署合约的交易不满足需求",110:"基本的交易类型需求校验失败",111:"交易类型未知",112:"恢复时间未知",113:"交易被重放",114:"交易的 data 字段太大，超过系统限制",115:"交易消耗的 gas 太大，超过系统限制",116:"交易的提交账户在区块链上不存在，提交账户是交易数据结构中的 from 字段",117:"交易的提交账户为空",118:"交易的提交账户被冻结",119:"交易的提交账户正在恢复中",120:"交易的目标账户在区块链上不存在，目标账户是交易数据结构中的 to 字段",121:"交易的目标账户被冻结",122:"交易的签名权重不足",123:"交易的目标账户已经存在",124:"块指针为空",125:"块的父级不存在",126:"块的父级无效，因为哈希和块号不匹配",127:"块的时间戳不满足单调递增的要求",128:"块的交易根哈希未正确计算",129:"块的交易接收根哈希未正确计算",130:"块的共识证明无效",131:"其他错误",132:"不满足交易的 group id 约束要求",133:"不满足交易的版本约束要求",134:"账户为空",135:"合约为空",136:"验证权限失败",137:"锚数据验证失败",140:"验证预留ID失败",141:"已打开受管理的应用程序合同",142:"更新合同无效",143:"更新合同状态无效",144:"不允许更新数据合同",145:"当前交易的合同代码无效",146:"已打开受管理的系统合约",400:"插件不存在",401:"消息转换失败",402:"本地交易执行失败",403:"无法将交易推送至缓存队列",404:"查询无结果",405:"业务不支持",406:"事件不存在",407:"日志实例不存在",408:"交易验证失败",409:"无节点可转发请求",410:"请求转发超时",411:"响应转发超时",412:"添加群链失败",413:"交易尚未验证",414:"交易已验证，等待执行",415:"节点无法提供服务，可能有两种原因：<br>1. 当前链在指定时间内无法成块；<br>2. 当前链内请求积压超过设定限制",416:"用于根据时间戳查询区块，请求中的时间戳小于创世块的时间戳",417:"转发请求查询无结果，可能是被转发节点处于无法服务状态",418:"注册事件失败，可能是触发事件注册单个 session 事件注册数限制或者节点支持最大事件注册数限制",419:"参数无效",420:"请求权限校验不通过，可能原因有：<br>1. 管理类请求需要校验签名，校验签名不通过；<br>2. 交易内账户涉及黑名单，被节点拒绝",421:"内部错误",422:"故障点不可用",423:"更新故障点案例失败",424:"超出了请求限制",425:"子网不存在",426:"子网不可用",1e3:"世界状态（WS）数据库未初始化",1001:"世界状态中找不到合约的代码哈希",1002:"世界状态中未找到该状态对象",1003:"状态对象（ID）被占用",1004:"指定的状态对象（ID）已删除",1005:"指定的状态对象余额不足",1006:"转账失败",1007:"指定的公钥不存在",1008:"余额溢出",1009:"未知故障",1010:"指定的权重值无效",1012:"发布资产失败",1013:"回收资产失败",2e3:"交易执行无法从交易获取足够的燃料",2001:"交易执行无法在区块链中定位到标识",2002:"负载中的权重值无效",2003:"交易负载无效",2004:"恢复时间无效",2005:"交易执行出现未知错误",3e3:"块不存在",3001:"数据库没有数据",3002:"写入数据库失败",3003:"从数据库读取数据失败",3004:"RLP存储解析失败",3005:"无效的ID",3006:"当前数据库的根目录状态无效",3007:"设置根目录失败",3008:"当前数据库数据丢失",3009:"数据覆盖失败",3010:"当前事件状态为空",3011:"最近块为空",3012:"区块编码无效",3013:"存储快照版本失败",3014:"对象状态初始化失败",3015:"对象状态接收无效",3016:"交易上下文为空",3017:"处理内容为空",3018:"merkle 树初始化失败",3019:"清理所有 merkle 树的缓存失败",3020:"清空所有merkle 树的状态失败",4e3:"超过要求的限制",4001:"创建group ID失败",4002:"获取公私钥失败",4003:"存储有关信息失败",4004:"发送已创建分组账号的交易失败",4005:"发送合约分组交易失败",4006:"获取公钥失败",4007:"公钥匹配出错",4008:"节点信息解码错误",4009:"获取密钥对失败",1e4:"虚拟机一般故障",10001:"错误的指令，包含create/create2/suicide/…",10002:"请调整堆栈",10003:"请调整堆栈",10004:"内存错误",10005:"代码为空",10006:"强制重启",10010:"虚拟机版本无效",10025:"由虚拟机参数不匹配引起的错误",10026:"虚拟机更新合约失败",10100:"虚拟机消耗超出限制",10101:"虚拟机创建失败",10102:"虚拟机参数代码为空",10103:"虚拟机参数代码为空",10200:"燃料不足",10201:"由 revert 指令触发的错误",10202:"由 toUint64 方法触发的错误",10203:"由虚拟机上下文static_call为true引起的错误",10204:"虚拟机方法引起的错误",10300:"获取余额失败",10301:"设置存储失败= 108，一般由存储引起",10302:"获取存储失败，一般由加载引起",10303:"转账失败，一般由evm_call调用方法引起",10304:"获取代码失败，一般由extcodecopy/extcodesize instruction or evm_call调用方法引起",10305:"获取块哈希失败，一般由哈希指令引起",10306:"获取代码哈希失败，由用户不存在引起",10307:"受获取燃料受限，由genesis.json设置",10308:"删除存储失败，原因是客户端收到删除存储结果失败",10309:"帐户被冻结，无法调用",10310:"虚拟机获取交易数据失败",10311:"虚拟机获取交易发送方失败",10312:"虚拟机获取交易交易接收器失败",10313:"虚拟机获取交易时间戳失败",10314:"虚拟机获取交易块索引失败",10315:"虚拟机从min_query_block中获取交易",10316:"交易类型不是TX_NATIVE_DEPOSIT_DATA和TX_RELATED_DEPOSIT_DATA",10317:"虚拟机获取交易存款标志失败",10318:"虚拟机获取恢复密钥失败",10319:"虚拟机获取身份验证映射失败",10350:"获得相关交易失败",10500:"虚拟内部错误",10600:"虚拟机创建动态库失败，可能是由本机合约创建动态库引起的",10601:"虚拟机创建socket失败，可能是由本机合约创建的socket方法引起的",10602:"虚拟机绑定socket失败，可能是由于客户端绑定到mychain时的本机协定引起的",10603:"虚拟机侦听socket失败，可能是由于mychain侦听客户端时的本机协定引起的",10604:"虚拟机响应失败，可能是由本机合同响应将数据发送给客户端造成的",10605:"虚拟机读取数据失败，可能是由于mychian读取客户端数据时的本机协定引起的",10606:"虚拟机执行子进程运行客户端失败",10607:"虚拟机fork进程失败，可能是由fork子进程时的本机合约引起的",10608:"虚拟机写入数据失败，可能是由于mychain将数据写入客户端时的幼稚合同引起的",10620:"虚拟机不支持本机合约，可能是由genesis.json中的native_enable引起的",10622:"虚拟机初始化失败，可能是由本地合约初始化方法引起",10623:"虚拟机不部署失败，可能是由于本地合约code引起部署失败",10700:"vm不支持本机预编译协定，没有使用ENABLE_NATIVE_PRECOMPILE_CONTRACT构建",10701:"虚拟机初始化失败，可能是由本机预编译协定init方法引起的",10702:"虚拟机部署失败，可能是由本机预编译合同部署代码引起的",10703:"虚拟机响应失败，可能是由本机预编译合同响应将数据发送给客户端引起的",10750:"合约 ID 不存在",10751:"数据库 ID 不存在",10752:"没有阅读数据合同的许可",10753:"没有写入数据合同的许可",10754:"没有删除数据合同的许可",10755:"数据协定API的输出是固定的，数据流反序列化输出失败",10756:"之前的schema不存在",10757:"当前的schema不存在",10758:"ACL ID不存在",10760:"数据不存在",10900:"参数格式错误",10901:"JSON/XML 的目标路径不存在",10902:"传入的 handler 参数不存在，检查 property_parse 是否执行成功",10903:"数据类型不匹配，当前使用的方法不能获取目标类型的数据",2e4:"SDK 内部错误",20001:"IPC/网络参数错误：协议族不支持的地址族",20002:"IPC/网络参数错误：该地址已被使用",20003:"IPC/网络参数错误：无法分配请求的地址",20004:"IPC/网络运行出错：套接口已连接",20005:"参数列表太长",20006:"数值参数不在域内",20007:"地址不详",20008:"文件描述符不详",20009:"程序加载错误：消息不详",20010:"管道破损",20011:"IPC/网络运行出错：软件问题导致连接中断",20012:"非阻塞和中断 I/O：操作进行中",20013:"IPC/网络运行出错：连接被拒绝",20014:"连接被对方重设",20015:"跨设备链接",20016:"IPC/网络参数错误：目标地址不得为空",20017:"设备或资源忙",20018:"目录不为空，需重新安排",20019:"执行格式错误",20020:"文件已存在",20021:"文件太大",20022:"IPC/网络运行出错：文件名太长",20023:"网络文件系统：功能未实现",20024:"无主机路由，需重新安排",20025:"程序加载错误：标识已被删除",20026:"程序加载错误：非法字节序列",20027:"ioctl 不适合设备",20028:"系统调用中断",20029:"参数无效",20030:"非法寻求",20031:"输入/输出错误",20032:"此为目录",20033:"IPC/网络参数错误：消息太长",20034:"IPC/网络运行出错：网络故障",20035:"IPC/网络运行出错：重置时网络断开连接",20036:"IPC/网络运行出错：网络无法访问",20037:"IPC/网络运行出错：无缓冲空间",20038:"无子程序",20039:"程序加载错误：已保留",20040:"网络文件系统，无锁可用",20041:"程序加载错误：消息流上无消息",20042:"程序加载错误：无预期类型的消息",20043:"IPC/网络参数错误：协议不可用",20044:"设备空间不足",20045:"程序加载错误：无流资源",20046:"设备未配置",20047:"设备不支持该操作",20048:"该文件或目录不存在",20049:"该程序不存在",20050:"非目录",20051:"IPC/网络参数错误：未在套接口上执行套接口操作",20052:"程序加载错误：非流",20053:"IPC/网络运行出错：套接口未连接",20054:"无法分配内存",20055:"IPC/网络参数错误：不支持该操作",20056:"程序加载错误：操作已取消",20057:"非阻塞和中断 I/O：操作进行中",20058:"操作不允许",20059:"仅当编译 __DARWIN_UNIX03 时该值为离散值，或 KERNE：套接口不支持该操作",20060:"非阻塞和中断 I/O：操作将阻塞",20061:"程序加载错误：之前的 Owner 已去世",20062:"权限不足",20063:"程序加载错误：协议错误",20064:"IPC/网络参数错误：不支持该协议",20065:"只读文件系统",20066:"避免资源死锁",20067:"非阻塞和中断 I/O：资源暂时不可用",20068:"结果太大",20069:"程序加载错误：状态不可恢复",20070:"程序加载错误：流 ioctl 超时",20071:"文本文件忙",20072:"IPC/网络运行出错：运行超时",20073:"系统打开的文件太多",20074:"打开的文件太多",20075:"太多链接",20076:"IPC/网络运行出错：符号链接级别太多",20077:"智能设备错误：值太大导致无法存储在数据类型中",20078:"IPC/网络参数错误：套接口协议类型错误",3e4:"SDK 参数无效",30001:"SDK 私钥无效",30002:"SDK 签名工具验证出错",30003:"SDK 不支持编码",30004:"SDK 获取文件输入流失败",30005:"SDK 查找线程失败",30006:"SDK 字节操作失败",30007:"SDK 转换公钥失败",30008:"SDK 消息编码失败",30009:"SDK 读取客户端配置失败",30010:"SDK 初始化失败",30011:"SDK 连接网络失败",30012:"SDK 解码出错",30013:"SDK 不支持该消息类型",30014:"未做握手",30015:"初始化 SSL 上下文失败",30016:"SDK 正在握手",30017:"SDK 无效的公钥",30018:"邮件已达到最大队列大小",60001:"加密交易解密失败",60002:"加密交易中内嵌的不是明文交易",60003:"待处理的交易非加密交易",60004:"TEE 中不支持 native 类型的合约",60005:"加密交易反序列化失败",60006:"合约账户的状态反序列化失败",60007:"非法访问加密的账户数据",60008:"TEE 内不支持的交易类型",60009:"加密回执中的 log 信息失败",60010:"非法访问加密的合约代码",60011:"加密交易的 hash 和时间戳不合法",60012:"交易回执过大",60013:"TEE 内部错误",60014:"合约代码加密失败",60015:"合约代码解密失败",60016:"合约状态加密失败",60017:"合约状态解密失败",60018:"合约状态反序列化失败",60019:"合约状态序列化失败",60020:"合约账户基本信息解密失败",60021:"合约账户基本信息加密失败",60022:"TEE 中不允许执行明文合约",60023:"TEE 中不允许更新明文合约",60024:"按不存在的方法类型进行查询",60025:"查询时使用的 hash 不存在",60026:"不允许查询",60027:"解密隐私交易回执失败",60028:"对象状态初始化失败",60029:"获取代码状态失败",60030:"删除存储状态失败",60031:"错误的虚拟机类型",60032:"设置代码状态失败",60033:"查询时交易不匹配",60034:"从块获取交易列表失败",60035:"查询时调用虚拟机失败",60036:"查询时不被允许",60037:"查询RLP失败",60038:"更新合约无效",60039:"查询时该方法不支持",60040:"加密交易的期望合约代码哈希值不匹配",60041:"更新存款合同时，获取公钥失败",7e4:"通用错误",70001:"无效的提供者",70002:"无效的密钥类型",70003:"无效的类",70004:"无效的公钥",70005:"无效的私钥",70006:"无效的消息",70007:"无效的纯文本",70008:"无效的密文",70009:"无效的签名",70010:"无效的对称密钥",70011:"无效的文件路径",70012:"无效的密钥文件",70013:"无效的x509",70101:"算法未初始化",70102:"提供者错误",8e4:"注册失败"};!function(e){e.OpenLab="0b06e2744ad341538b7a3b3cc5ad9e57"}(Ko||(Ko={}));var Lo=function(){function n(e){a(this,n),this.requestConfig=void 0,this.tokenPromise=void 0,this.requestConfig=e,this.tokenPromise=this.getToken()}var s,c;return o(n,[{key:"getToken",value:(c=r(t.mark((function e(){var r,n,a,o,s,c,i,u,p,f;return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(r=this.requestConfig).accessSecret,o=r.baseUrl,te("[RestRequest] getToken accessId:",n=r.accessId),te("[RestRequest] getToken accessSecret:",a),s=""+Date.now(),c=za(a,"".concat(n).concat(s)),e.next=7,Oo("".concat(o,"/api/contract/shakeHand"),{method:"POST",body:{time:s,accessId:n,secret:c}});case 7:if(u=(i=e.sent).code,p=i.data,f=i.message,!i.success||"200"!==u){e.next=15;break}return te("[RestRequest] getToken token:",p),e.abrupt("return",p);case 15:throw Error(f);case 16:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"request",value:(s=r(t.mark((function r(n){var a,o,s,c,i,u,p,f,h,y,l=arguments;return t.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=l.length>1&&void 0!==l[1]?l[1]:{},o=l.length>2&&void 0!==l[2]?l[2]:1,s=this.requestConfig.baseUrl+n,t.next=5,this.tokenPromise;case 5:return c=t.sent,i=a.requestStr?{requestStr:JSON.stringify(a.requestStr)}:{},u=e(e(e({},a),i),{},{token:c}),te("[RestRequest] request url & tokenTimeoutRetryTimes:",s,o),te("[RestRequest] request body:",u),t.next=12,Oo(s,{method:"POST",body:u});case 12:if(te("[RestRequest] response body:",p=t.sent),!p.success||!("200"===p.code||"0"===p.code&&a.secretKey)){t.next=28;break}if(!/\{.+\}/.test(p.data)){t.next=25;break}return t.prev=16,t.abrupt("return",JSON.parse(p.data));case 20:throw t.prev=20,t.t0=t.catch(16),new oe("response parse error, code: ".concat(p.code),p.code);case 23:t.next=26;break;case 25:return t.abrupt("return",p.data);case 26:t.next=39;break;case 28:if("202"!==p.code||0>=o){t.next=34;break}return te("[RestRequest] token timeout, retry get token, tokenTimeoutRetryTimes: ".concat(o)),this.tokenPromise=this.getToken(),t.abrupt("return",this.request(n,a,o-1));case 34:if(f=Do[p.code]||p.code,y=p.data,/\{.+\}/.test(p.data))try{(y=JSON.parse(p.data)).output&&(h=""+Buffer.from(y.output,"base64"))}catch(e){}throw h?f="".concat(f," ").concat(h):p.data?f="".concat(f," ").concat(p.data):p.message&&(f="".concat(f," ").concat(p.message)),new oe("[RestRequest] request failed, code: ".concat(p.code,", detail: ").concat(f),p.code,y);case 39:case"end":return t.stop()}}),r,this,[[16,20]])}))),function(e){return s.apply(this,arguments)})}]),n}();function Wo(e,t){return t.request("/api/contract/chainCallForBiz",e)}function Uo(e,t){return t.request("/api/contract/chainCall",e)}function zo(e,t){return t.request("/api/contract/chainCall",e)}function Mo(e,t){return t.request("/api/contract/chainCall",e)}function Fo(e,t){return t.request("/api/contract/chainCall",e)}function jo(e,t){return t.request("/api/contract/chainCall",e)}function Ho(e,t){return t.request("/api/contract/chainCall",e)}function Qo(e,t){return t.request("/api/contract/chainCallForBiz",e)}function Vo(e,t){return t.request("/api/contract/chainCall",e)}function Yo(e,t){return t.request("/api/contract/chainCall",e)}function Jo(e,t){return t.request("/api/contract/chainCall",e)}function Go(e,t){return t.request("/api/contract/chainCallForBiz",e)}function $o(e,t){return t.request("/api/contract/chainCallForBiz",e)}function Xo(e,t){return t.request("/api/contract/chainCall",e)}var Zo=Object.freeze({__proto__:null,deployContractForBiz:Wo,deployContract:Uo,queryAccount:zo,queryBlockHeader:Mo,queryBlock:Fo,queryLastBlock:jo,queryTransaction:Ho,callContractForBiz:Qo,callContract:Vo,queryContract:Yo,queryTransactionReceipt:Jo,createAccountForBiz:Go,updateContractForBiz:$o,updateContract:Xo});function es(e){return Buffer.from(e,"base64").toString("hex")}function ts(e){return"0x".concat(function(e){var t=K.md.sha256.create();return t.update(e),t.digest().toHex()}(e))}var rs=function(n){c(H,Za);var s,u,p,f,h,y,l,d,m,v,g,_,k,w,b,x,C,q,E,T,S,P,N,B,I,R,K,A,O,L,U,z,M,F,j=i(H);function H(e){var t;return a(this,H),(t=j.call(this)).majorVersion=1,t.config=void 0,t.request=void 0,t.config=e,t.request=new Lo({baseUrl:t.config.restUrl,accessId:t.config.accessId,accessSecret:t.config.accessSecret}),t}return o(H,[{key:"getToken",value:function(){return this.request.getToken()}},{key:"generateOrderId",value:function(){return"order_myfish_".concat(this.config.accessId,"_").concat(D())}},{key:"watchContractEvent",value:function(e,t,r){throw Error("Not support yet.")}},{key:"createAccount",value:function(){var e=r(t.mark((function e(){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("托管密钥方式请使用 createAccountWithKms");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"createAccountWithKms",value:(F=r(t.mark((function e(r){var n;return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(this.config.tenantId).concat(W()),e.next=3,Go({newAccountId:r.newAccountName,newAccountKmsId:n,method:ee.createAccountForBiz,accessId:this.config.accessId,bizid:this.config.bizid,account:this.config.account,tenantid:this.config.tenantId,mykmsKeyId:this.config.kmsId,orderId:this.generateOrderId()},this.request);case 3:return e.abrupt("return",{kmsId:n,authKey:e.sent});case 5:case"end":return e.stop()}}),e,this)}))),function(e){return F.apply(this,arguments)})},{key:"transferBalance",value:function(){var e=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"setRecoverkey",value:function(){var e=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"preResetPubKey",value:function(){var e=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"resetPubKey",value:function(){var e=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"freezeAccount",value:(M=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return M.apply(this,arguments)})},{key:"freezeContract",value:(z=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return z.apply(this,arguments)})},{key:"nativeDepositData",value:(U=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return U.apply(this,arguments)})},{key:"queryLastBlockHeader",value:(L=r(t.mark((function e(){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(){return L.apply(this,arguments)})},{key:"queryTransactionList",value:(O=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return O.apply(this,arguments)})},{key:"queryTransactionAndReceipt",value:(A=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return A.apply(this,arguments)})},{key:"queryTimestamp",value:(K=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return K.apply(this,arguments)})},{key:"queryP2PStatus",value:(R=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return R.apply(this,arguments)})},{key:"queryConsensusStatus",value:(I=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return I.apply(this,arguments)})},{key:"queryCommonConsensusStatus",value:(B=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return B.apply(this,arguments)})},{key:"querySyncStatus",value:(N=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return N.apply(this,arguments)})},{key:"queryTransactionCacheStatus",value:(P=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return P.apply(this,arguments)})},{key:"queryBlockCacheStatus",value:(S=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return S.apply(this,arguments)})},{key:"queryContractNodesStatus",value:(T=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return T.apply(this,arguments)})},{key:"queryContractConfigStatus",value:(E=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return E.apply(this,arguments)})},{key:"queryLogLevel",value:(q=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return q.apply(this,arguments)})},{key:"updateBlackList",value:(C=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return C.apply(this,arguments)})},{key:"queryBlockProof",value:(x=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return x.apply(this,arguments)})},{key:"queryBlockHeaderProof",value:(b=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return b.apply(this,arguments)})},{key:"queryStateProof",value:(w=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return w.apply(this,arguments)})},{key:"queryTransactionProof",value:(k=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return k.apply(this,arguments)})},{key:"queryReceiptProof",value:(_=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return _.apply(this,arguments)})},{key:"queryBlockHeaderInfos",value:(g=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return g.apply(this,arguments)})},{key:"queryBlockReceiptInfos",value:(v=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return v.apply(this,arguments)})},{key:"queryBlockBodyInfos",value:(m=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return m.apply(this,arguments)})},{key:"queryAccount",value:(d=r(t.mark((function e(r){var n,a;return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.account,e.next=3,zo({method:ee.queryAccount,requestStr:{queryAccount:n},bizid:this.config.bizid,accessId:this.config.accessId},this.request);case 3:return e.abrupt("return",{address:(a=e.sent).id,balance:a.balance,encryptionKey:a.encryption_key,recoveryKey:a.recovery_key,recoveryTime:a.recovery_time,authMap:a.auth_map.map((function(e){return{key:e.key,weight:e.value}})),status:a.status,version:a.version});case 5:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"updateAuthMap",value:function(){var e=r(t.mark((function e(){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Rest 暂不支持 updateAuthMap");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"queryBlockHeader",value:(l=r(t.mark((function e(r){var n;return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.blockNumber,e.next=3,Mo({method:ee.queryBlockHeader,requestStr:n,bizid:this.config.bizid,accessId:this.config.accessId},this.request);case 3:return e.abrupt("return",e.sent.block.blockHeader);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"queryBlock",value:(y=r(t.mark((function e(r){var n,a;return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.blockNumber,e.next=3,Fo({method:ee.queryBlock,requestStr:n,bizid:this.config.bizid,accessId:this.config.accessId},this.request);case 3:return e.abrupt("return",{gasUsed:(a=e.sent).header.gas_used,hash:a.header.hash,logBloom:a.header.log_bloom,number:a.header.number,parentHash:a.header.parent_hash,receiptRoot:a.header.receipt_root,stateRoot:a.header.state_root,timestamp:a.header.timestamp,transactionRoot:a.header.transaction_root,version:a.header.version,receiptList:a.body.receipt_list,consensusProof:a.body.consensus_proof,transactionList:a.body.transaction_list});case 5:case"end":return e.stop()}}),e,this)}))),function(e){return y.apply(this,arguments)})},{key:"queryLastBlock",value:(h=r(t.mark((function e(){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,jo({method:ee.queryLastBlock,bizid:this.config.bizid,accessId:this.config.accessId},this.request);case 2:return e.abrupt("return",e.sent.block.blockHeader);case 4:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"queryTransaction",value:(f=r(t.mark((function e(r){var n,a,o;return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.hash,a=r.tee,e.next=3,Ho({method:ee.queryTransactionFromBlockchain,hash:n,bizid:this.config.bizid,accessId:this.config.accessId,secretKey:a?this.config.teePassword:void 0},this.request);case 3:return e.abrupt("return",{blockNumber:(o=e.sent).blockHeight,hash:"0x".concat(o.hash),data:o.transactionV10.data,from:"0x".concat(o.transactionV10.from),to:"0x".concat(o.transactionV10.to)});case 5:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"queryTransactionReceipt",value:(p=r(t.mark((function e(r){var n;return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Jo({method:ee.queryTransactionReceipt,hash:r.hash,bizid:this.config.bizid,accessId:this.config.accessId,secretKey:r.tee?this.config.teePassword:void 0},this.request);case 2:return te("[CloudCryptoRestProvider] queryTransactionReceipt gas used:",(n=e.sent).gasUsed),e.abrupt("return",{blockNumber:n.blockNumber,gasUsed:n.gasUsed,output:es(n.output),code:n.result,logs:n.logs.map((function(e){return{from:Ba(e.from.value),to:Ba(e.to.value),logData:es(e.logData),topics:e.topics}}))});case 5:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"deployContract",value:function(){var n=r(t.mark((function r(n,a,o){var s,c,i,u,p,f,h;return t.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.vmType!==$.WASM){t.next=4;break}s=null===(c=a.code)||void 0===c?void 0:c.toString("base64"),t.next=9;break;case 4:if(n.vmType!==$.EVM){t.next=8;break}s=null===(i=a.code)||void 0===i?void 0:i.toString("utf-8"),t.next=9;break;case 8:throw Error("[deployContract] vmType must be ".concat($.WASM," or ").concat($.EVM));case 9:if(u={accessId:this.config.accessId,bizid:this.config.bizid,contractCode:s,account:this.config.account,tenantid:this.config.tenantId,mykmsKeyId:this.config.kmsId,orderId:this.generateOrderId(),contractName:n.contractName,gas:a.gas,secretKey:a.tee?this.config.teePassword:void 0},!o){t.next=16;break}return t.next=13,$o(e(e({},u),{},{method:n.vmType===$.WASM?ee.updateWasmContractForBiz:ee.updateSolidityContractForBizAsync}),this.request);case 13:p=t.sent,t.next=19;break;case 16:return t.next=18,Wo(e(e({},u),{},{method:n.vmType===$.WASM?ee.deployWasmContractForBiz:ee.deploySolidityContractForBizAsync}),this.request);case 18:p=t.sent;case 19:if(f=n.vmType===$.WASM?p.txData.txHash:p,!a.tee){t.next=24;break}return f=Buffer.from(f.value,"base64").toString("hex"),h=wt(this.config.teePassword,f).toString("hex"),t.abrupt("return",{txHash:f,teeSecret:h});case 24:return t.abrupt("return",{txHash:f});case 25:case"end":return t.stop()}}),r,this)})));return function(e,t,r){return n.apply(this,arguments)}}()},{key:"updateContract",value:function(){var e=r(t.mark((function e(r,n){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.deployContract(r,n,!0));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"callContract",value:function(){var e=r(t.mark((function e(r,n){var a,o,s,c,i,u,p,f,h,y,l,d,m,v,g,_,k,w,b,x,C;return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.methodName,s=void 0===(o=n.args)?[]:o,i=void 0===(c=n.argsType)?[]:c,u=n.returnType,p=n.gas,f=n.tee,h=n.local,y=n.timeout,l=r.contractName,d=r.abi,r.vmType!==$.EVM){e.next=4;break}throw Error("[callContract] Rest 托管密钥方式暂时不支持调用 Solidity 合约");case 4:return e.next=6,Qo({methodSignature:"".concat(a,"(").concat(i?i.join(","):"",")"),inputParamListStr:JSON.stringify(s),outTypes:u?'["'.concat(u,'"]'):"[]",method:ee.callWasmContractForBizAsync,accessId:this.config.accessId,bizid:this.config.bizid,account:this.config.account,tenantid:this.config.tenantId,mykmsKeyId:this.config.kmsId,orderId:this.generateOrderId(),contractName:l,isLocalTransaction:h,gas:p,secretKey:f?this.config.teePassword:void 0},this.request);case 6:return v="0x".concat(m=e.sent),g=f?wt(this.config.teePassword,v).toString("hex"):"",te("[CloudCryptoRestProvider] callContract txHash:",m),te("[CloudCryptoRestProvider] callContract teeSecret:",g),e.next=13,this.queryTransactionReceiptWithRetry({hash:v,tee:f},y?Date.now()+y:void 0);case 13:return w=(_=e.sent).code,te("[CloudCryptoRestProvider] callContract output:",b=k=_.output),x=Fa(l,d),f&&k&&(b=qt(k,this.config.teePassword,m)),C=Na(a,x,b),e.abrupt("return",{returnValue:C,txHash:v,teeSecret:f?g:void 0,receiptCode:w});case 22:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"queryContract",value:(u=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Yo({method:ee.queryContract,bizid:this.config.bizid,contractName:r.contractName,accessId:this.config.accessId},this.request);case 2:return e.abrupt("return",{code:e.sent.contract.code});case 4:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"sign",value:(s=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("暂不支持");case 1:case"end":return e.stop()}}),e)}))),function(e){return s.apply(this,arguments)})}]),H}(),ns=function(n){c(y,rs);var s,u,p,f,h=i(y);function y(e){var t;return a(this,y),(t=h.call(this,{bizid:e.bizid,restUrl:e.restUrl,accessId:e.accessId,accessSecret:e.accessSecret})).localConfig=void 0,t.localConfig=e,t}return o(y,[{key:"getBaseData",value:(f=r(t.mark((function e(){var r;return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ja(this.localConfig.accountPrivateKey,this.localConfig.accountPrivateKeyPassword);case 2:return e.abrupt("return",{isSign:!0,from:this.localConfig.account,userPublicKey:(r=e.sent).publicKey,userPrivateKey:r.privateKey});case 4:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"sign",value:(p=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getBaseData();case 2:return e.abrupt("return",{signature:kt(r.payload,e.sent.userPrivateKey).toString("hex")});case 4:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"createAccount",value:function(){var e=r(t.mark((function e(){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Rest 非托管密钥方式暂不支持创建账户");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"deployContract",value:(u=r(t.mark((function r(n,a,o){var s,c,i,u,p,f,h,y;return t.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getBaseData();case 2:if(s=t.sent,c=n.generateDeployCode(a.code),i=Ia(o?Z.updateContract:Z.deployContract,{from:o?n.contractName:s.from,to:n.contractName,gas:a.gas,data:{code:c}},s,(function(e){return e[1]})),u=i.txData,p=i.rlpData,a.tee&&(f=wt(this.localConfig.teePassword,u.hash).toString("hex")),h={accessId:this.config.accessId,bizid:this.config.bizid,hash:u.hash,method:ee.deployWasmContract,requestStr:{hash:u.hash,timestamp:u.timestamp,vmTypeEnum:n.vmType,secretKey:a.tee?this.localConfig.teePassword:void 0}},!o){t.next=13;break}return t.next=10,Xo(e(e({},h),{},{method:ee.updateWasmContract,requestStr:e(e({},h.requestStr),{},{contractName:ts(n.contractName),contractCode:c,vmType:n.vmType,updateContractRaw:p.toString("base64")})}),this.request);case 10:y=t.sent,t.next=16;break;case 13:return t.next=15,Uo(e(e({},h),{},{method:ee.deployWasmContract,requestStr:e(e({},h.requestStr),{},{deployContractRaw:p.toString("base64")})}),this.request);case 15:y=t.sent;case 16:return t.next=18,this.queryTransactionReceiptWithRetry({hash:u.hash,tee:a.tee});case 18:return t.abrupt("return",{txHash:y,teeSecret:f});case 19:case"end":return t.stop()}}),r,this)}))),function(e,t,r){return u.apply(this,arguments)})},{key:"callContract",value:(s=r(t.mark((function e(r,n){var a,o,s,c,i,u,p,f,h,y,l,d,m,v,g,_,k,w,b,x,C,q;return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=n.gas,i=void 0===(c=n.argsType)?[]:c,u=n.local,p=n.tee,f=n.timeout,h=r.contractName,y=r.vmType,l=r.generateCallCode(a=n.methodName,void 0===(o=n.args)?[]:o),e.next=5,this.getBaseData();case 5:if(m=Ia(Z.callContract,{from:(d=e.sent).from,to:h,gas:s,data:{parameter:l}},d,(function(e){return e[1]})),v=m.txData,g=m.rlpData,p&&(_=wt(this.localConfig.teePassword,v.hash).toString("hex")),y!==$.WASM){e.next=11;break}return e.next=11,Vo({accessId:this.config.accessId,bizid:this.config.bizid,hash:v.hash,method:ee.callWasmContract,requestStr:{acctId:{data:Va(v.from)},contractId:{data:Va(v.to)},callWasmContractRaw:g.toString("base64"),methodSignature:"".concat(a,"(").concat(i?i.join(","):"",")"),hash:v.hash,timestamp:v.timestamp,nonceV:Date.now(),vmTypeEnum:$.WASM,isLocalTransaction:u,teePublicKey:p?this.localConfig.teePublicKey:void 0,secretKey:p?this.localConfig.teePassword:void 0}},this.request);case 11:if(y!==$.EVM){e.next=14;break}return e.next=14,Vo({accessId:this.config.accessId,bizid:this.config.bizid,hash:v.hash,contractName:h,method:ee.callContract,requestStr:{callContractRaw:g.toString("base64"),hash:v.hash,timestamp:v.timestamp,nonceV:Date.now(),vmTypeEnum:$.EVM}},this.request);case 14:return e.next=16,this.queryTransactionReceiptWithRetry({hash:v.hash,tee:p},f?Date.now()+f:void 0);case 16:return b=(k=e.sent).code,x=w=k.output,p&&w&&(C="0x"+Buffer.from(w,"base64").toString("hex"),x=Va(qt(C,this.localConfig.teePassword,v.hash))),q=r.parseReturnOutput(a,x),e.abrupt("return",{returnValue:q,txHash:v.hash,teeSecret:p?_:void 0,receiptCode:b});case 23:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})}]),y}();function as(e){console.warn("[myfish] WalletProvider.".concat(e," 方法暂不支持 TEE 合约"))}var os=function(n){c(W,Za);var s,u,p,f,h,y,l,d,m,v,g,_,k,w,b,x,C,q,E,T,S,P,N,B,I,R,K,A,O,L=i(W);function W(e){var t;return a(this,W),(t=L.call(this)).majorVersion=1,t.config=void 0,t.rpcEngine=void 0,t.rpcConnection=void 0,t.state={chainId:"",accounts:[],isConnected:!1},t.config=e,t.initRpcEngine(),t.initState(),t}return o(W,[{key:"initRpcEngine",value:function(){this.rpcEngine=new U,this.rpcConnection=z(),this.rpcEngine.push(this.rpcConnection.middleware),M(this.config.connectionStream,this.rpcConnection.stream,this.config.connectionStream,(function(e){console.error("[WalletProvider] stream disconnect",e)}))}},{key:"initState",value:(O=r(t.mark((function r(){var n;return t.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.request({method:re.getProviderState});case 2:n=t.sent,this.state=e(e({},this.state),n),this.state.isConnected=!0,te("[WalletProvider] initState:",this.state),this.emit("connect",this.state);case 7:case"end":return t.stop()}}),r,this)}))),function(){return O.apply(this,arguments)})},{key:"request",value:(A=r(t.mark((function e(r){var n,a,o,s,c;return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.params,te("[WalletProvider] request method:",n=r.method),te("[WalletProvider] request params:",a),e.next=5,this.rpcEngine.handle({jsonrpc:"2.0",id:D(),method:n,params:a});case 5:if(c=(o=e.sent).result,!(s=o.error)){e.next=11;break}throw te("[WalletProvider] request error:",s),s;case 11:return te("[WalletProvider] request result:",c),e.abrupt("return",c);case 13:case"end":return e.stop()}}),e,this)}))),function(e){return A.apply(this,arguments)})},{key:"watchContractEvent",value:function(e,t,r){throw Error("Not support yet.")}},{key:"requestAccounts",value:(K=r(t.mark((function e(){var r;return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request({method:re.requestAccounts});case 2:return this.state.accounts=r=e.sent,this.emit("accountsChanged",r),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)}))),function(){return K.apply(this,arguments)})},{key:"createAccount",value:function(){var e=r(t.mark((function e(){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("WalletProvider 暂不支持创建账户");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"transferBalance",value:function(){var e=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"setRecoverkey",value:function(){var e=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"preResetPubKey",value:function(){var e=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"resetPubKey",value:function(){var e=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"freezeAccount",value:(R=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return R.apply(this,arguments)})},{key:"freezeContract",value:(I=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return I.apply(this,arguments)})},{key:"nativeDepositData",value:(B=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return B.apply(this,arguments)})},{key:"queryLastBlockHeader",value:(N=r(t.mark((function e(){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(){return N.apply(this,arguments)})},{key:"queryTransactionList",value:(P=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return P.apply(this,arguments)})},{key:"queryTransactionAndReceipt",value:(S=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return S.apply(this,arguments)})},{key:"queryTimestamp",value:(T=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return T.apply(this,arguments)})},{key:"queryP2PStatus",value:(E=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return E.apply(this,arguments)})},{key:"queryConsensusStatus",value:(q=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return q.apply(this,arguments)})},{key:"queryCommonConsensusStatus",value:(C=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return C.apply(this,arguments)})},{key:"querySyncStatus",value:(x=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return x.apply(this,arguments)})},{key:"queryTransactionCacheStatus",value:(b=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return b.apply(this,arguments)})},{key:"queryBlockCacheStatus",value:(w=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return w.apply(this,arguments)})},{key:"queryContractNodesStatus",value:(k=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return k.apply(this,arguments)})},{key:"queryContractConfigStatus",value:(_=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return _.apply(this,arguments)})},{key:"queryLogLevel",value:(g=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return g.apply(this,arguments)})},{key:"updateBlackList",value:(v=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return v.apply(this,arguments)})},{key:"queryBlockProof",value:(m=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return m.apply(this,arguments)})},{key:"queryBlockHeaderProof",value:(d=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return d.apply(this,arguments)})},{key:"queryStateProof",value:(l=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return l.apply(this,arguments)})},{key:"queryTransactionProof",value:(y=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return y.apply(this,arguments)})},{key:"queryReceiptProof",value:(h=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return h.apply(this,arguments)})},{key:"queryBlockHeaderInfos",value:(f=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return f.apply(this,arguments)})},{key:"queryBlockReceiptInfos",value:(p=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return p.apply(this,arguments)})},{key:"queryBlockBodyInfos",value:(u=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("Not support yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return u.apply(this,arguments)})},{key:"updateAuthMap",value:function(){var e=r(t.mark((function e(){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("WalletProvider 暂不支持 updateAuthMap");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"queryAccount",value:function(e){return this.request({method:re.queryAccount,params:e})}},{key:"queryBlockHeader",value:function(e){return this.request({method:re.queryBlockHeader,params:e})}},{key:"queryBlock",value:function(e){return this.request({method:re.queryBlock,params:e})}},{key:"queryLastBlock",value:function(){return this.request({method:re.queryLastBlock})}},{key:"queryTransaction",value:function(e){return e.tee&&as("queryTransaction"),this.request({method:re.queryTransaction,params:e})}},{key:"queryTransactionReceipt",value:function(e){return e.tee&&as("queryTransactionReceipt"),this.request({method:re.queryTransactionReceipt,params:e})}},{key:"deployContract",value:function(t,r){return r.tee&&as("deployContract"),this.request({method:re.deployWasmContract,params:e(e({},t),{},{contractName:t.contractName,contractType:t.contractType,abi:t.abi})})}},{key:"updateContract",value:function(){throw Error("wallet provider 暂不支持 updateContract")}},{key:"callContract",value:function(t,r){return(null==r?void 0:r.tee)&&as("callContract"),this.request({method:t.contractType===G.solidity?re.callSolidityContract:re.callWasmContract,params:e(e({methodName:t.methodName,args:t.args},r),{},{contractName:t.contractName,contractType:t.contractType,abi:t.abi})})}},{key:"queryContract",value:function(e){return this.request({method:re.queryContract,params:e})}},{key:"sign",value:(s=r(t.mark((function e(r){return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Error("暂不支持");case 1:case"end":return e.stop()}}),e)}))),function(e){return s.apply(this,arguments)})}]),W}();export{oe as AntchainSDKError,Za as BaseProvider,Ko as ChainIds,Ao as ChainProvider,rs as CloudCryptoRestProvider,ue as Contract,G as ContractType,ae as EventListenerType,ns as LocalCryptoRestProvider,Z as MychainMethods,ee as RestMethods,ne as RestMethodsUrlMap,Zo as RestServices,Ka as SolContract,X as TxType,$ as VmType,re as WalletMethods,os as WalletProvider,Ja as WasmContract,Va as convertHex2Base64,J as createDebug,te as debug,qt as decryptAESWithPassword,Ea as decryptTXWithAES,Do as errorCodeMessages,wt as generateAESKey,Fa as getAbier,ja as getUserInfo,V as isChromeBackground,F as isDebug,j as isDev,H as isElectron,Q as isNode,$a as maxQueryTransactionReceiptRetryInterval,Ma as parsePrivateKeyToAES,Xa as queryTransactionReceiptRetryInterval,Ya as remove0x,za as signMessage,Qa as toUTF8};
