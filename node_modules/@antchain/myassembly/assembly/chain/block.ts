import { ENV, utils, assert } from '..';

/**
 * 获取最新区块的编号
 * @returns u64
 */
export function getBlockNumber(): u64 {
  return ENV.GetBlockNumber();
}

/**
 * 获取最新区块的时间戳
 * @returns
 */
export function getBlockTimeStamp(): u64 {
  return ENV.GetBlockTimeStamp();
}

/**
 * 获取指定区块的 hash
 * @param blockNumber 区块编号
 */
export function getBlockHash(blockNumber: u64): string {
  const data = utils.allocData(ENV.HashLength);
  const res = ENV.GetBlockHash(blockNumber, data.ptr, data.lengthPtr);
  assert(res === 0, `[getBlockHash] failed, blockNumber: ${blockNumber}`);
  return utils.bytesToHexString(data.bytes);
}
