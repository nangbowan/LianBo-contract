const debug = require('debug')('myassembly:tester:GetStorageSize');

module.exports =
  ({ __storage, __getString, __storeU32 }) =>
  (key_ptr, key_length, value_length_ptr) => {
    const key = __getString(key_ptr, key_length);
    let storageSize = 0;

    if (__storage.has(key)) {
      storageSize = __storage.get(key).byteLength;
    }
    debug(key, storageSize);
    __storeU32(value_length_ptr, storageSize);
  };
