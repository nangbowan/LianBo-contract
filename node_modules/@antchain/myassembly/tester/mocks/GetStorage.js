const debug = require('debug')('myassembly:tester:GetStorage');

module.exports =
  ({ __storage, __storeU8Array, __getString }) =>
  (key_ptr, key_length, value_ptr, value_length_ptr) => {
    const key = __getString(key_ptr, key_length);
    let value = new Uint8Array();
    if (__storage.has(key)) {
      value = __storage.get(key);
    }

    debug(key, value);
    // TODO: assert(value.byteLength === getStorageSize(key), '');

    __storeU8Array(value_ptr, value);
  };
